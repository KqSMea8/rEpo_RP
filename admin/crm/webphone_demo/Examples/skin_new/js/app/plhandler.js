define(["jquery","webphone","common","stringres","global"],function(e,t,n,r,i){function s(e,r,i){try{if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){if(!n.isNull(i)){var s;for(s in i){if(!n.isNull(s)&&s.length>0&&!n.isNull(i[s]))y(s,i[s])}}return t.Start(e,r)}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){t.StartWin()}}catch(o){n.PutToDebugLogException(2,"plhandler: Start",o)}return false}function o(s,o,u){try{if(n.isNull(s)||s.length<1){s=-1}if(n.isNull(o)||n.Trim(o).lengh<1){n.PutToDebugLog(1,r.get("err_msg_4"));return false}o=n.Trim(o);if(n.isNull(u)){u=""}i.intentcall[0]="number="+o;i.intentcall[1]="calltype=outgoing";i.intentcall[2]="name="+u;setTimeout(function(){e.mobile.changePage("#page_call",{transition:"pop",role:"page"})},20);if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){return t.Call(s,o)}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){n.WinAPI("API_Call",null,s,o)}}catch(a){n.PutToDebugLogException(2,"plhandler: Call",a)}return false}function u(e){try{if(n.isNull(e)||e.length<1){e=-1}if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){return t.Hangup(e)}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){n.WinAPI("API_Hangup",null,e)}}catch(r){n.PutToDebugLogException(2,"plhandler: Hangup",r)}return false}function a(e){try{if(n.isNull(e)||e.length<1){e=-2}if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){return t.Accept(e)}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){n.WinAPI("API_Accept",null,e)}}catch(r){n.PutToDebugLogException(2,"plhandler: Accept",r)}return false}function f(e){try{if(n.isNull(e)||e.length<1){e=-2}if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){return t.Reject(e)}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){n.WinAPI("API_Reject",null,e)}}catch(r){n.PutToDebugLogException(2,"plhandler: Reject",r)}return false}function l(e,i){try{if(n.isNull(e)||e.length<1){e=-1}if(n.isNull(i)){n.PutToDebugLog(1,r.get("err_msg_4"));return false}i=n.Trim(i);if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){return t.Conference(e,i)}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){n.WinAPI("API_Conf",null,e,i)}}catch(s){n.PutToDebugLogException(2,"plhandler: Conference",s)}return false}function c(e,i){try{if(n.isNull(e)||e.length<1){e=2}if(n.isNull(i)){n.PutToDebugLog(1,r.get("err_msg_4"));return false}i=n.Trim(i);if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){return t.Transfer(e,i)}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){n.WinAPI("API_Transfer",null,e,i)}}catch(s){n.PutToDebugLogException(2,"plhandler: Transfer",s)}return false}function h(e,i){try{if(n.isNull(e)||e.length<1){e=-1}if(n.isNull(i)){n.PutToDebugLog(1,r.get("err_msg_4"));return false}i=n.Trim(i);if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){return t.Dtmf(e,i)}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){n.WinAPI("API_Dtmf",null,e,i)}}catch(s){n.PutToDebugLogException(2,"plhandler: Dtmf",s)}return false}function p(e,r,i){try{if(n.isNull(e)||e.length<1){e=-1}if(n.isNull(i)||e.direction<1){i=3}if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){return t.MuteEx(e,r,i)}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){n.WinAPI("API_MuteEx",null,e,r,i);return true}}catch(s){n.PutToDebugLogException(2,"plhandler: MuteEx",s)}return false}function d(e,r){try{if(n.isNull(e)||e.length<1){e=-1}if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){return t.Hold(e,r)}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){n.WinAPI("API_Hold",null,e,r);return true}}catch(i){n.PutToDebugLogException(2,"plhandler: Hold",i)}return false}function v(e,i,s){try{if(n.isNull(e)||e.length<1){e=1}if(n.isNull(i)||n.Trim(i).length<1){n.PutToDebugLog(1,"ERROR, "+r.get("err_msg_6"));return false}if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){return t.SendChat(e,i,s)}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){n.WinAPI("API_SendChat",null,e,i,s)}}catch(o){n.PutToDebugLogException(2,"plhandler: SendChat",o)}return false}function m(){try{if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){return t.AudioDevice()}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){n.WinAPI("API_AudioDevice",null)}}catch(e){n.PutToDebugLogException(2,"plhandler: AudioDevice",e)}return false}function g(e,r){try{if(n.isNull(e)||e.length<1||n.isNull(r)||r.length<1||!n.IsNumber(e)||!n.IsNumber(r)){n.PutToDebugLog(3,"ERROR, wphone: setvolume device or volume is NULL");return false}var i=n.StrToInt(e);var s=n.StrToInt(r);if(i<0||i>2){n.PutToDebugLog(3,"ERROR, wphone: setvolume invalid device");return false}if(s<0||s>100){n.PutToDebugLog(3,"ERROR, wphone: setvolume invalid valume value");return false}if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){return t.SetVolume(e,r)}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){n.WinAPI("API_SetVolume",null,e,r)}}catch(o){n.PutToDebugLogException(2,"plhandler: SetVolume",o)}return false}function y(e,r){try{if(n.isNull(e)||e.length<1){return false}if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){return t.SetParameter(e,r)}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){n.WinAPI("API_SetParameter",null,e,r)}}catch(i){n.PutToDebugLogException(2,"plhandler: SetParameter",i)}return false}function b(){try{if(n.GetParameter("devicetype")===n.DEVICE_WEBPHONE()){return t.IsRegistered()}else if(n.GetParameter("devicetype")===n.DEVICE_WIN_SOFTPHONE()){n.WinAPI("API_IsRegistered",null)}}catch(e){n.PutToDebugLogException(2,"plhandler: IsRegistered",e)}return false}function w(){try{return n.HelpWindow()}catch(e){n.PutToDebugLogException(2,"plhandler: HelpWindow",e)}return false}function E(){try{n.OpenSettings();return true}catch(e){n.PutToDebugLogException(2,"plhandler: SettingsPage",e)}return false}function S(){try{e.mobile.changePage("#page_dialpad",{transition:"pop",role:"page"});return true}catch(t){n.PutToDebugLogException(2,"plhandler: DialPage",t)}return false}function x(){try{e.mobile.changePage("#page_messagelist",{transition:"none",role:"page"});return true}catch(t){n.PutToDebugLogException(2,"plhandler: MessageInboxPage",t)}return false}function T(){try{i.intentmsg[0]="action=";i.intentmsg[1]="to=";i.intentmsg[2]="message=";e.mobile.changePage("#page_message",{transition:"none",role:"page"});return true}catch(t){n.PutToDebugLogException(2,"plhandler: MessagePage",t)}return false}function N(){try{i.intentaddeditct[0]="action=add";e.mobile.changePage("#page_addeditcontact",{transition:"pop",role:"page"});return true}catch(t){n.PutToDebugLogException(2,"plhandler: AddContact",t)}return false}function C(e){try{t.InsertApplet(e)}catch(r){n.PutToDebugLogException(2,"plhandler: InsertApplet",r)}}function k(){try{return n.EnterKeyPress()}catch(e){n.PutToDebugLogException(2,"plhandler: EnterKeyPress",e)}return false}function L(e){try{n.bwanswer(e)}catch(t){n.PutToDebugLogException(2,"plhandler: bwanswer",t)}}function A(){try{if(i.wasSettModified){n.SaveSettingsFile(n.GetActiveAccSettingsFilename(),function(e){if(e){n.PutToDebugLog(2,"EVENT, SaveSettingsFile from onappexit Successfull")}else{n.PutToDebugLog(2,"ERROR, SaveSettingsFile from onappexit Failed")}})}}catch(e){n.PutToDebugLogException(2,"plhandler: onappexit",e)}}function O(){try{n.WinAPI("API_SetLogs",null,i.logs)}catch(e){n.PutToDebugLogException(2,"plhandler: getlogs",e)}}function M(){try{n.delsettings()}catch(e){n.PutToDebugLogException(2,"plhandler: delsettings",e)}}var _={Start:s,Call:o,Hangup:u,Accept:a,Reject:f,Conference:l,Transfer:c,Dtmf:h,MuteEx:p,Hold:d,SendChat:v,AudioDevice:m,SetVolume:g,SetParameter:y,IsRegistered:b,HelpWindow:w,SettingsPage:E,DialPage:S,MessageInboxPage:x,MessagePage:T,AddContact:N,InsertApplet:C,EnterKeyPress:k,bwanswer:L,onappexit:A,getlogs:O,delsettings:M};window.plhandler=_;return _})