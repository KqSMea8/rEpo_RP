define(["jquery","stringres","global"],function(bC,a3,r){var J={};var x="0";var be="1";var P="2";var bo="3";var h="4";var Q="5";var l=3;r.deviceType=x;function bc(){try{if(navigator.userAgent.search("iPad")<0&&navigator.userAgent.search("iPhone")<0&&navigator.userAgent.search("Android")<0&&navigator.userAgent.search("BlackBerry")<0&&navigator.userAgent.search("webOS")<0){return x}}catch(bQ){g(2,"common: GetUA",bQ)}return -1}var a5=null;var F=null;var c=null;var aO=(navigator.userAgent).toLowerCase();var bF=(aO.indexOf("msie")>0||aO.indexOf("trident")>0)?true:false;function e(bT,b1){try{var bS="";var bQ=0;if(bG(b1)||bG(bT)){return}if(bi(bT)){bQ=bT;bS=b1}else{if(bi(b1)){bQ=b1;bS=bT}else{return}}if(bQ===1){notifications_public.ReceiveNotifications(bS)}var bY=new Date();var bZ=bY.getHours();var bW=bY.getMinutes();var b0=bY.getSeconds();var b5=bY.getMilliseconds();if(bZ<10){bZ="0"+bZ}if(bW<10){bW="0"+bW}if(b0<10){b0="0"+b0}if(b5<10){b5="00"+b5}else{if(b5<100){b5="0"+b5}}var bV="["+bZ+":"+bW+":"+b0+"."+b5+"] ";if(r.deviceType>0||navigator.userAgent.toLowerCase().indexOf("firefox")>-1||navigator.userAgent.toLowerCase().indexOf("chrome")>-1){if(bS.indexOf("ERROR")>-1){try{console.error(bV+bS)}catch(b4){}}else{try{console.log(bV+bS)}catch(b3){}}}else{try{if(!bG(console)&&!bG(console.log)){console.log(bV+bS)}}catch(b2){}}if(bQ>r.loglevel){return}if(r.loglevel<2){return}r.logs=r.logs+bV+bS+"&#10;";if(r.logs.length>600000){var bR=r.logs.substring(0,10000);r.logs=bR+r.logs.substring(300000)}return;if(r.loglevel>1&&j()===DEVICE_PC()){if(bG(a5)){a5=window.open("logs.html","_blank","widthwindow.open=400, height=420, top=550, menubar=no, scrollbars=yes, status=no, titlebar=no, toolbar=no")}if(bG(F)){F=[]}c=document.createElement("DIV");c.innerHTML=bV+bS;F.push(c);if(!bG(a5.document.body)){if(!bG(F)&&F.length>0){for(var bX=0;bX<F.length;bX++){if(bF){bC(a5.document.getElementsByTagName("body")).append(aI(F.shift()))}else{a5.document.body.appendChild(F[bX])}}}}}}catch(bU){alert(bU)}}function aI(bS){try{if(bS.xml){return bS.xml}else{if(XMLSerializer){var bQ=new XMLSerializer();return bQ.serializeToString(bS)}else{return""}}}catch(bR){alert(bR)}}function g(bU,bT,bR){try{var bS="";if(bG(bT)||bG(bU)){return}if(typeof(bR)==="undefined"||bR===null){e(bU,"ERROR, catch on "+bT+" unknown exception")}else{if(typeof(bR.message)!=="undefined"&&bR.message!==null&&(bR.message).length>0){bS=bS+" ("+bR.message+") "}if(typeof(bR.fileName)!=="undefined"&&bR.fileName!==null&&(bR.fileName).length>0){bS=bS+" class: "+bR.fileName}if(typeof(bR.lineNumber)!=="undefined"&&bR.lineNumber!==null&&(bR.fileName).lineNumber>0){bS=bS+": "+bR.lineNumber}e(bU,"ERROR, catch on "+bT+" "+bR+bS)}}catch(bQ){}}function v(bT,bS,bR){try{if(bG(bT)||bG(bS)||bG(bR)){e(3,"ERROR, common ReplaceAll null value");return""}return bT.replace(new RegExp(b(bS),"g"),bR)}catch(bQ){g(2,"common: ReplaceAll",bQ)}return""}function aa(bR){try{if(bG(bR)||bR.lenght<1){return""}return bR.replace(/^\s+|\s+$/g,"")}catch(bQ){g(2,"common: Trim",bQ)}return bR}function b(bR){try{if(bG(bR)||bR.lenght<1){e(3,"ERROR, common EscapeRegExp null value");return""}return bR.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}catch(bQ){g(2,"common: EscapeRegExp",bQ)}return""}function bi(bR){try{if(typeof(bR)==="undefined"||bR==null){return false}bR=bR.toString();bR=bR.replace(/\s+/g,"");if(bR==null||bR.length<1){return false}return !isNaN(bR)}catch(bQ){g(2,"common: IsNumber",bQ)}return false}function bb(bR){try{if(bG(bR)||!bi(bR)){return null}else{bR=v(bR," ","");return parseInt(bR,10)}}catch(bQ){g(2,"common: StrToInt",bQ)}return null}function ak(bR){try{if(bG(bR)){return 0}bR=v(bR," ","");return parseInt(bR,10)}catch(bQ){g(2,"common: StrToIntPx",bQ)}return 0}function k(){try{return Math.floor((bC("#phone_app_main_container").width()))}catch(bQ){g(2,"common: GetDeviceWidth",bQ)}}function aC(){try{return Math.floor((bC("#phone_app_main_container").height()))}catch(bQ){g(2,"common: GetDeviceHeight",bQ)}}function q(){return false}var i=false;var n=false;function ah(){try{if(i===true){return n}var bQ=window.location.href;if(bG(bQ)||bQ.length<1){i=true;return n}bQ=aa(bQ);if(bQ.indexOf("platform")>0&&bQ.indexOf("windesktop")>0){i=true;n=true;return n}}catch(bR){g(2,"common: IsWindowsSoftphone",bR)}return n}function j(){return r.deviceType}function a2(){return x}function bl(){return be}function a1(){return P}function ax(){return bo}function bL(){return h}function H(){return Q}function bG(bQ){try{if(typeof(bQ)==="undefined"||bQ===null){return true}else{return false}}catch(bR){g(2,"common: isNull",bR)}return true}function bO(bQ){try{var bR="#000000";if(bC(bQ).length>0){var bT=bC(bQ).css("background-color");var bV=bT.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);delete (bV[0]);for(var bS=1;bS<=3;++bS){bV[bS]=parseInt(bV[bS]).toString(16);if(bV[bS].length==1){bV[bS]="0"+bV[bS]}}bR="#"+bV.join("")}return bR}catch(bU){g(2,"common: getBgColor",bU)}return"#000000"}function U(bQ){try{var bR="#000000";if(bC(bQ).length>0){var bT=bC(bQ).css("color");var bV=bT.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);delete (bV[0]);for(var bS=1;bS<=3;++bS){bV[bS]=parseInt(bV[bS]).toString(16);if(bV[bS].length==1){bV[bS]="0"+bV[bS]}}bR="#"+bV.join("")}return bR}catch(bU){g(2,"common: getElementColor",bU)}return"#000000"}function a(bS,bR,bQ){setTimeout(function(){aV(bS,bR,bQ)},100)}function aV(bV,bT,bQ){try{var bU=k();if(!bG(bU)&&bi(bU)&&bU>100){bU=Math.floor(bU/1.2)}else{bU=220}var bR='<div data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+bU+'px;"><div data-role="header" data-theme="b"><a href="#" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+bV+'</h1></div><div role="main" class="ui-content adialog_content adialog_alert"><span> '+bT+' </span></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="#" style="width: 98%;" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+a3.get("btn_close")+"</a></div></div>";bQ=bQ?bQ:function(){};bC.mobile.activePage.append(bR).trigger("create");bC.mobile.activePage.find(".closePopup").bind("tap",function(bW){bC.mobile.activePage.find(".messagePopup").popup("close")});bC.mobile.activePage.find(".messagePopup").bind({popupbeforeposition:function(){bC(this).unbind("popupbeforeposition");var bW=Math.floor(aC()*0.6);if(bC(this).height()>bW){bC(".messagePopup .ui-content").height(bW)}}});bC.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){bC(this).unbind("popupafterclose").remove();bQ()}})}catch(bS){g(2,"common: AlertDialog",bS)}}function bq(bR,bQ){setTimeout(function(){T(bR,bQ)},100)}function T(bT,bQ){try{var bU=k();if(!bG(bU)&&bi(bU)&&bU>100){bU=Math.floor(bU/1.2)}else{bU=220}var bR='<div data-role="popup" style="padding: .5em;" class="ui-content toastPopup" data-overlay-theme="b" data-transition="fade" data-theme="a" style="max-width:'+bU+'px"><span> '+bT+" </span></div>";bQ=bQ?bQ:function(){};bC.mobile.activePage.append(bR).trigger("create");bC.mobile.activePage.find(".closePopup").bind("tap",function(bV){bC.mobile.activePage.find(".toastPopup").popup("close")});bC.mobile.activePage.find(".toastPopup").popup().popup("open").bind({popupafterclose:function(){bC(this).unbind("popupafterclose").remove();bQ()}});setTimeout(function(){bC.mobile.activePage.find(".toastPopup").popup("close")},3000)}catch(bS){g(2,"common: ShowToast",bS)}}function ao(bU,bX){try{var bV=k();if(!bG(bV)&&bi(bV)&&bV>100){bV=Math.floor(bV/1.2)}else{bV=220}var bR="";var bZ='<li id="[ITEMID]"><a data-rel="back">[ITEMTITLE]</a></li>';var bT=v(a3.get("help_text"),"[BRANDNAME]",a3.get("app_name"));var bW="";if(!r.customizedversion&&!bG(bT)&&bT.length>3){bW=bZ.replace("[ITEMID]","#item_help");bW=bW.replace("[ITEMTITLE]",a3.get("help_help"));bR=bR+bW;bW=""}bW=bZ.replace("[ITEMID]","#item_loging");bW=bW.replace("[ITEMTITLE]",a3.get("help_loging"));bR=bR+bW;bW="";if(!r.customizedversion){if(wphone.treatuserserverinputasupperserver==="false"){bW=bZ.replace("[ITEMID]","#item_proversion");bW=bW.replace("[ITEMTITLE]",a3.get("help_proversion"));bR=bR+bW;bW="";var bS=0;bS=bb(bs("successfulcalls"));bW=bZ.replace("[ITEMID]","#item_rate");bW=bW.replace("[ITEMTITLE]",a3.get("help_rate"));bR=bR+bW;bW=""}bW=bZ.replace("[ITEMID]","#item_about");bW=bW.replace("[ITEMTITLE]",a3.get("help_about"));bR=bR+bW;bW=""}var bY='<div id="help_window" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+bV+"px; min-width: "+Math.floor(bV*0.6)+'px;"><div data-role="header" data-theme="b"><a href="#" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+a3.get("menu_help")+'</h1></div><div role="main" class="ui-content adialog_content" style="padding: 0; margin: 0;"><ul id="help_window_ul" data-role="listview" data-inset="true" data-icon="false" style="margin: 0;">'+bR+'</ul></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="#" style="width: 98%;" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+a3.get("btn_close")+"</a></div></div>";bX=bX?bX:function(){};bC.mobile.activePage.append(bY).trigger("create");bC.mobile.activePage.find(".closePopup").bind("tap",function(b0){bC.mobile.activePage.find(".messagePopup").popup("close")});bC.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){bC(this).unbind("popupafterclose").remove();bC("#help_window_ul").off("click","li");bX()}});bC("#help_window_ul").on("click","li",function(b0){var b1=bC(this).attr("id");bC("#help_window").on("popupafterclose",function(b3){bC("#help_window").off("popupafterclose");if(b1==="#item_help"){a(a3.get("menu_help"),bT)}else{if(b1==="#item_proversion"){s()}else{if(b1==="#item_loging"){O()}}}if(b1==="#item_rate"){alert("not implemented yet")}if(b1==="#item_about"){var b4=a3.get("help_about")+" "+a3.get("app_name");var b2=v(a3.get("dlg_about_msg"),"[BRANDNAME]",a3.get("app_name"));b2=v(b2,"[APPVERSION]",a3.get("app_version_str"));a(b4,b2)}})})}catch(bQ){g(2,"common: HelpWindow",bQ)}}function O(bQ){try{var bW=k();if(!bG(bW)&&bi(bW)&&bW>100){bW=Math.floor(bW/1.2)}else{bW=220}var bV="";var bU='<li id="[ITEMID]"><a data-rel="back">[ITEMTITLE]</a></li>';var bT="";if(bs("log")==="true"){bT=bU.replace("[ITEMID]","#item_stoplog");bT=bT.replace("[ITEMTITLE]",a3.get("help_stoplog"));bV=bV+bT;bT="";bT=bU.replace("[ITEMID]","#item_sendlog");bT=bT.replace("[ITEMTITLE]",a3.get("help_sendlog"));bV=bV+bT;bT=""}else{bT=bU.replace("[ITEMID]","#item_startlog");bT=bT.replace("[ITEMTITLE]",a3.get("help_startlog"));bV=bV+bT;bT=""}var bR='<div id="log_window" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+bW+"px; min-width: "+Math.floor(bW*0.6)+'px;"><div data-role="header" data-theme="b"><a href="#" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+a3.get("help_loging")+'</h1></div><div role="main" class="ui-content adialog_content" style="padding: 0; margin: 0;"><ul id="log_window_ul" data-role="listview" data-inset="true" data-icon="false" style="margin: 0;">'+bV+'</ul></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="#" style="width: 98%;" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+a3.get("btn_close")+"</a></div></div>";bQ=bQ?bQ:function(){};bC.mobile.activePage.append(bR).trigger("create");bC.mobile.activePage.find(".closePopup").bind("tap",function(bX){bC.mobile.activePage.find(".messagePopup").popup("close")});bC.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){bC(this).unbind("popupafterclose").remove();bC("#log_window_ul").off("click","li");bQ()}});bC("#log_window_ul").on("click","li",function(bX){var bY=bC(this).attr("id");bC("#log_window").on("popupafterclose",function(bZ){bC("#log_window").off("popupafterclose");if(bY==="#item_startlog"){A("log","true");A("loglevel",r.predefLoglevel);A("jsscriptevent","3");wphone.setparameter("jsscriptevent","3");r.loglevel=r.predefLoglevel}else{if(bY==="#item_stoplog"){A("log","false");A("loglevel","1");A("jsscriptevent","2");wphone.setparameter("jsscriptevent","2");r.loglevel=1;bC("#log_text").html("")}else{if(bY==="#item_sendlog"){bC.mobile.changePage("#page_logview",{transition:"pop",role:"page"})}}}})})}catch(bS){g(2,"common: LogWindow",bS)}}function s(bQ){try{var bT=k();if(!bG(bT)&&bi(bT)&&bT>100){bT=Math.floor(bT/1.2)}else{bT=220}var bR='<div data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+bT+'px;"><div data-role="header" data-theme="b"><a href="#" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+a3.get("help_proversion")+'</h1></div><div role="main" class="ui-content adialog_content adialog_alert"><span> '+a3.get("proversion_content_text")+' </span><input type="text" id="proversion_input" name="setting_item" data-theme="a"/></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="#" id="btn_upgrade" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+a3.get("btn_upgrade")+'</a><a href="#" id="adialog_negative" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back">'+a3.get("btn_cancel")+"</a></div></div>";bQ=bQ?bQ:function(){};bC.mobile.activePage.append(bR).trigger("create");bC.mobile.activePage.find(".closePopup").bind("tap",function(bU){bC.mobile.activePage.find(".messagePopup").popup("close")});bC.mobile.activePage.find(".messagePopup").bind({popupbeforeposition:function(){bC(this).unbind("popupbeforeposition");var bU=Math.floor(aC()*0.6);if(bC(this).height()>bU){bC(".messagePopup .ui-content").height(bU)}}});bC.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){bC(this).unbind("popupafterclose").remove();bC("#btn_upgrade").off("click");bQ()}});bC("#btn_upgrade").on("click",function(){alert("upgrade, not implemented yet")})}catch(bS){g(2,"common: UpgradeToProVersion",bS)}}function w(){try{var bR=new Date();return bR.getTime()}catch(bQ){g(2,"common: GetTickCount",bQ)}return 0}function E(bS,bR){try{var bV=bS;var bX=bS.indexOf("#");if(bX>=0){bS=bS.substring(bX+1)}if(bS.length===6){var bW=parseInt(bS.substring(0,2),16);var bU=parseInt(bS.substring(2,4),16);var bQ=parseInt(bS.substring(4,6),16);if((bW+bR)>255){bW=bW-bR}else{if((bW+bR)<0){bW=bW-bR}else{bW=bW+bR}}if((bU+bR)>255){bU=bU-bR}else{if((bU+bR)<0){bU=bU-bR}else{bU=bU+bR}}if((bQ+bR)>255){bQ=bQ-bR}else{if((bQ+bR)<0){bQ=bQ-bR}else{bQ=bQ+bR}}bW=bW.toString(16);bU=bU.toString(16);bQ=bQ.toString(16);if(bW.length<2){bW="0"+bW}if(bU.length<2){bU="0"+bU}if(bQ.length<2){bQ="0"+bQ}bS="#"+bW+bU+bQ}else{if(bS.length===3){var bW=parseInt(bS.substring(0,1),16);var bU=parseInt(bS.substring(1,2),16);var bQ=parseInt(bS.substring(2,3),16);if((bW+bR)>255){bW=bW-bR}else{if((bW+bR)<0){bW=bW-bR}else{bW=bW+bR}}if((bU+bR)>255){bU=bU-bR}else{if((bU+bR)<0){bU=bU-bR}else{bU=bU+bR}}if((bQ+bR)>255){bQ=bQ-bR}else{if((bQ+bR)<0){bQ=bQ-bR}else{bQ=bQ+bR}}bW=bW.toString(16);bU=bU.toString(16);bQ=bQ.toString(16);if(bW.length<2){bW="0"+bW}if(bU.length<2){bU="0"+bU}if(bQ.length<2){bQ="0"+bQ}bS="#"+bW+bU+bQ}else{return bV}}return bS}catch(bT){g(2,"common: HoverCalc",bT)}return""}var R=false;var aD=false;function bt(){try{if(R===true){return aD}R=true;var bR=C();if(bG(bR)){return}bR=bR.toLowerCase();var bQ=window.location.href;if(bG(bQ)){return}bQ=bQ.toLowerCase();bQ=aa(bQ);if(bR==="msie"&&bQ.indexOf("http")<0&&bQ.indexOf("https")<0){aD=true;e(2,"common: IsIeLocalFilesystem: IE from local file system")}}catch(bS){g(2,"common: IsIeLocal",bS)}return aD}function ad(bQ){try{if(bG(bQ)){return false}var bS=navigator.userAgent;var bR=/MSIE\s?(\d+)(?:\.(\d+))?/i;var bU=bS.match(bR);if(!bG(bU)&&!bG(bU[0])&&bU[0].indexOf(bQ)>=0){return true}}catch(bT){g(2,"common: IsIeVersion",bT)}return false}var aN=null;var al=null;function C(){try{if(bG(aN)||bG(al)){var bQ=navigator.userAgent.toLowerCase();e(2,"common: GetBrowser name: "+bQ);if((bQ.indexOf("msie")!==-1)&&(bQ.indexOf("opera")===-1)){aN="MSIE";al="MSIE"}else{if(bQ.indexOf("trident")!==-1||bQ.indexOf("Trident")!==-1){aN="MSIE";al="MSIE"}else{if(bQ.indexOf("iphone")!==-1){aN="Netscape Family";al="iPhone"}else{if((bQ.indexOf("firefox")!==-1)&&(bQ.indexOf("opera")===-1)){aN="Netscape Family";al="Firefox"}else{if(bQ.indexOf("chrome")!==-1){aN="Netscape Family";al="Chrome"}else{if(bQ.indexOf("safari")!==-1){aN="Netscape Family";al="Safari"}else{if((bQ.indexOf("mozilla")!==-1)&&(bQ.indexOf("opera")===-1)){aN="Netscape Family";al="Other"}else{if(bQ.indexOf("opera")!==-1){aN="Netscape Family";al="Opera"}else{aN="?";al="unknown"}}}}}}}}e(2,"common: GetBrowser Detected browser name: "+aN+";  "+al)}}catch(bR){g(2,"common: GetBrowser",bR)}return al}function az(b0,bY){try{var bX=k();if(!bG(bX)&&bi(bX)&&bX>100){bX=Math.floor(bX/1.2)}else{bX=220}var bW=aC();if(!bG(bW)&&bi(bW)&&bW>100){bW=Math.floor(bW/1.5)}else{bW=250}var bV="";for(var bU=0;bU<r.ctlist.length;bU++){var bQ=r.ctlist[bU];if(bG(bQ)||bQ.length<1){continue}var bS=bQ[bj];if(bG(bS)||bS.length<1){var bT=b1[V];if(bG(bT)||bT.length<1||bG(bT[0])||bT[0].length<1){continue}bS=bT[0]}var b1='<li id="pickcontact_'+bU+'"><a data-rel="back">'+bS+"</a></li>";bV=bV+b1}var bZ='<div id="pickcontact_popup" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+bX+"px; min-width: "+Math.floor(bX*0.6)+'px;"><div data-role="header" data-theme="b"><a href="#" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+a3.get("pick_ct")+'</h1></div><div role="main" class="ui-content adialog_content adialog_alert" style="padding: 0; margin: 0;"><ul id="pickcontact_ul" data-role="listview" data-inset="true" data-icon="false" data-filter="true" data-filter-placeholder="Search Contacts" data-autodividers="true" style="margin: 0; max-height: '+bW+'px;">'+bV+'</ul></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="#" style="width: 98%;" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+a3.get("btn_close")+"</a></div></div>";bY=bY?bY:function(){};bC.mobile.activePage.append(bZ).trigger("create");bC.mobile.activePage.find(".closePopup").bind("tap",function(b2){bC.mobile.activePage.find(".messagePopup").popup("close")});bC.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){bC(this).unbind("popupafterclose").remove();bC("#pickcontact_ul").off("click","li");bY()}});bC("#pickcontact_ul").on("click","li",function(b4){var b7=bC(this).attr("id");var b5="";var b6=b7.indexOf("_");if(b6<2){e(2,"ERROR, common PickContact OnListItemClick invalid id: "+b7);return}b5=aa(b7.substring(b6+1));var b3=r.ctlist[b5];if(bG(b3)||b3.length<1){e(3,"ERROR, PickContact ctentry is NULL");return}var b2=b3[V];if(b2.length===1){b0(b2[0],b3[bj]);return}bC("#pickcontact_popup").on("popupafterclose",function(b8){bC("#pickcontact_popup").off("popupafterclose");bh(b5,b0)})})}catch(bR){g(2,"common: PickContact",bR)}}function bh(bS,bY,bW){try{if(!bY||typeof(bY)!=="function"){e(2,"ERROR, PickContactNumber callback is NULL");return}var bU=k();if(!bG(bU)&&bi(bU)&&bU>100){bU=Math.floor(bU/1.2)}else{bU=220}var bV=r.ctlist[bS];if(bG(bV)||bV.length<1){e(3,"ERROR, PickContactNumber ctentry is NULL");return}var b0=bV[V];var bT="";for(var bR=0;bR<b0.length;bR++){if(bG(b0[bR])||b0[bR].length<1){continue}var bZ='<li id="pickcontactnumber_'+bR+'"><a data-rel="back">'+b0[bR]+"</a></li>";bT=bT+bZ}var bX='<div id="pickcontactnumber_popup" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+bU+"px; min-width: "+Math.floor(bU*0.6)+'px;"><div data-role="header" data-theme="b"><a href="#" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+bV[bj]+'</h1></div><div role="main" class="ui-content adialog_content adialog_alert" style="padding: 0; margin: 0;"><ul id="pickcontactnumber_ul" data-role="listview" data-inset="true" data-icon="false" style="margin: 0;">'+bT+'</ul></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="#" style="width: 98%;" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+a3.get("btn_close")+"</a></div></div>";bW=bW?bW:function(){};bC.mobile.activePage.append(bX).trigger("create");bC.mobile.activePage.find(".closePopup").bind("tap",function(b1){bC.mobile.activePage.find(".messagePopup").popup("close")});bC.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){bC(this).unbind("popupafterclose").remove();bC("#pickcontactnumber_ul").off("click","li");bW()}});bC("#pickcontactnumber_ul").on("click","li",function(b2){var b4=bC(this).attr("id");var b1="";var b3=b4.indexOf("_");if(b3<2){e(2,"ERROR, common PickContactNumber OnListItemClick invalid nrid: "+b4);return}b1=aa(b4.substring(b3+1));bC("#pickcontactnumber_popup").on("popupafterclose",function(b5){bC("#pickcontactnumber_popup").off("popupafterclose");bY(b0[b1],bV[bj])})})}catch(bQ){g(2,"common: PickContactNumber",bQ)}}function bm(bR){try{if(bG(bR)){return""}if(bR.indexOf("@")>0){return bR}bR=bR.replace("-","");bR=bR.replace(" ","");bR=bR.replace("(","");bR=bR.replace(")","");bR=aa(bR)}catch(bQ){g(2,"common: StripSpecialChar",bQ)}return bR}var a0=0;var bN=1;var d=2;var bD=3;var aA=4;var aX=5;var W=99;var Z="-1";var bM="0";var aP="1";var B="2";var ar="3";var K="4";var ac="5";var bp="8";function ag(){try{ab("serveraddress_user","","8",bM,"","","1");ab("serveraddress_orig","","-1",Z,"","","1");ab("upperserver","","-1","-1","","","1");ab("sipusername","","1",bM,"","","1");ab("password","","1",bM,"","","1");ab("settlevelbasic","true","-1",Z,"","","1");ab("submenu_sipsettings","","6",bM,"","","1");ab("submenu_media","","6",bM,"","","1");ab("submenu_video","","6",B,"","","1");ab("submenu_calldivert","","6",bM,"","","1");ab("submenu_general","","6",bM,"","","1");ab("submenu_integrate","","6",K,"","","1");ab("register","1","2",aP,"No,Auto Guess,Yes","0,1,2","1");ab("registerinterval","180","1",aP,"","","1");ab("cfgcpuspeed","0","2",B,"Auto guess,Very slow (<600 MHz ARMv6),Slow (<900 MHz),Medium (900-1100 MHz),High (>1100 MHz),Very High (>1400 MHz or multi core)","0,1,2,3,4,5","1");ab("cfgnetworkspeed","0","2",B,"Auto guess,Slow (< 20 KBits on GPRS or 3G),Normal (20 - 60 kbits),Fast (> 60 KBits)","0,1,2,3","1");ab("codec","-1","3",B,"Optimal,PCMU,PCMA,GSM,iLBC,SPEEX,SPEEX-WB,G.729","-1,1,2,3,4,5,6,8","1");ab("dtmfmode","2","2",aP,"Disabled,Sip INFO method,RFC2833 in the RTP (if RTP stream is working, otherwise it will send also SIP INFO),Both INFO and RFC2833,RFC2833 (will not send SIP INFO even if there is no RTP stream negotiated)","0,1,2,3,4","1");ab("audiorecorder","1","2",B,"Default,Auto guess, Mic,Voice call,Voice downlink,Voice uplink,Voice communication","0,1,2,3,4,5,6","1");ab("audioplayer","-2147483648","2",B,"Default (Automatic),Alarm stream,Music playback,Notifications stream,Ring stream,System sounds,Voice call","-2147483648,4,3,5,2,1,0","1");ab("speakerphoneplayer","-2147483648","2",B,"Default (Automatic),Alarm stream,Music playback,Notifications stream,Ring stream,System sounds,Voice call,No change","-2147483648,4,3,5,2,1,0,6","1");ab("speakerphoneoutput","0","2",B,"Auto guess,Speaker,Speaker and mode,VoIP,Bluetooth,Normal,Mode only,No changes","0,1,2,3,4,5,6,7","1");ab("incomingcallalert","2","2",B,"Alarm stream,Music stream,Notifications stream,Ring stream,System sounds,Voice call stream","4,3,5,2,1,0","1");ab("autousebluetooth","0","2",B,"Guess,No,Yes","0,1,2","1");ab("playring","2","2",B,"No,For incomming calls,For incomming and outgoing calls","0,1,2","1");ab("volumein","50","4",B,"","","1");ab("volumeout","50","4",B,"","","1");ab("agc_orig","1","2",B,"No,Auto,For recording,Both for recording and playback","0,1,2,3","1");ab("aec_orig","-1","8",B,"Auto,None,Software,Native,Fast,Decrease volume","-1,0,1,2,3,4","1");ab("denoise_orig","1","2",B,"No,Auto,For recording,Both for recording and playback","0,1,2,3","1");ab("plc_orig","1","2",B,"No,Automatic,Yes","0,1,2","1");ab("silencesupress","-1","2",B,"Auto,No,Yes","-1,0,1","1");ab("hardwaremedia","0","2",B,"Auto,No,Yes","0,1,2","1");ab("setqos","0","2",B,"Auto,No,Yes","0,1,2","1");ab("codecframecount","0","2",B,"Auto,1,2,3,4,5,6","0,1,2,3,4,5,6","1");ab("doublesendrtp","0","2",B,"No,Yes","0,1","1");ab("ringtimeout","90000","1",aP,"","","1");ab("calltimeout","10800000","1",aP,"","","1");ab("displaynotification","2","2",K,"Never,On event,Always","0,1,2","1");ab("displayvolumecontrols","false","0",K,"","","1");ab("displayaudiodevice","false","0",K,"","","1");ab("use_stun","1","2",aP,"Force private IP,No,With stable NAT only,On all symmetric NAT,Always,Use even on public IP","-1,0,1,2,3,4","1");ab("prack","false","0",aP,"","","1");ab("localip","","1",aP,"","","1");ab("signalingport","","1",aP,"","","1");ab("rtpport","","1",aP,"","","1");ab("sendearlymedia","false","0",aP,"","","1");ab("jittersize","3","2",B,"No jitter,Extra small,Small,Normal,Big,Extra big,Max","0,1,2,3,4,5,6","1");ab("proxyaddress","","1",aP,"","","1");ab("username","","1",aP,"","","1");ab("displayname","","1",aP,"","","1");ab("email","","1",K,"","","1");ab("chatsms","0","2",aP,"Auto guess or Ask,SMS only,Chat only","0,1,2","1");ab("savetocontacts","1","2",K,"No,Ask,Yes (will not ask for a contact name)","0,1,2","1");ab("call_access","","7",K,"","","1");ab("autoanswer_forward","0","2",ar,"No,Answer,Forward,Transfer,Ignore,Reject","0,1,2,5,3,4","1");ab("transfertype","6","2",ar,"Unattended drop,Unattended with hold,Attanded (call first)","1,6,5","1");ab("callforwardonbusy","","1",ar,"","","1");ab("rejectonvoipbusy","3","2",ar,"Auto,Reject calls,Allow calls,Forward calls","3,0,1,2","1");ab("rejectonphonebusy","0","2",ar,"Reject calls,Allow calls,Forward calls","0,1,2","1");ab("voicemail","","1",ar,"","","1");ab("techprefix","","1",ar,"","","1");ab("filters","","5",ar,"","","1");ab("startonboot","true","0",K,"","","1");ab("startwithos","true","0",K,"","","1");ab("loglevel","1","1",K,"","","1");ab("log","false","0",K,"","","1");ab("new_user_reg_uri",aa(a3.get("new_user_reg_uri")),"-1",Z,"","","1");ab("provider_uri",aa(a3.get("provider_uri")),"-1",Z,"","","1");ab("account_uri",aa(a3.get("account_uri")),"-1",Z,"","","1");ab("recharge_uri",aa(a3.get("recharge_uri")),"-1",Z,"","","1");ab("p2p_uri",aa(a3.get("p2p_uri")),"1",ar,"","","1");ab("callback_uri",aa(a3.get("callback_uri")),"1",ar,"","","1");ab("sms_uri",aa(a3.get("sms_uri")),"1",ar,"","","1");ab("sms_uri_recieve",aa(a3.get("sms_uri_recieve")),"-1",Z,"","","1");ab("balance_uri",aa(a3.get("balance_uri")),"1",ar,"","","1");ab("rating_uri",aa(a3.get("rating_uri")),"1",ar,"","","1");ab("last_callback_nr","","-1",Z,"","","1");ab("callback_mode","0","2",ar,"No,Ask,On no internet,On no WIFI,Always","0,1,2,3,4","1");ab("accounts","","5",K,"","","1");ab("reset_settings","","8",K,"","","1");ab("androidvoicerecording","false","0",K,"","","1");ab("ringtone","","8",K,"Ringtone1,Ringtone2,Ringtone3","0,1,2","1");ab("changesptoring","2","2",aP,"Do nothing,Display ringing status,Start media,Start media and display ringing","0,1,2,3","1");ab("transport","0","2",aP,"UDP,TCP,TLS (beta),HTTP tunneling (both signaling and media),HTTP proxy connect,Auto (automatic failowering from UDP to HTTP if needed)","0,1,2,3,4,5","1");ab("defmute","3","2",aP,"No,Muted,Speakers only,Mic only,Both","0,1,2,3,4","1");ab("automute","0","2",ar,"No (default),On incoming call,On outgoing call,On incoming and outgoing calls,On other line button click","0,1,2,3,4","1");ab("autohold","0","2",ar,"No (default),On incoming call,On outgoing call,On incoming and outgoing calls,On other line button click","0,1,2,3,4","1");ab("customsipheader","","1",aP,"","","1");ab("sendrtponmuted","false","0",aP,"","","1");ab("capabilityrequest","false","0",aP,"","","1");ab("devtest","0,0,0,0,0,0,0,0,0","8",aP,"","","1");ab("enableaudio","true","0",ar,"","","1");ab("settobasefunctionality","true","8",bM,"","","1");ab("dialerintegration","false","0",ac,"","","1");ab("screenrotation","0","2",K,"Auto,No,Yes","0,1,2","1");ab("audiobufferlength","-1","1",B,"","","1");ab("keepalive","55","1",aP,"","","1");ab("cpualwayspartiallock","false","0",K,"","","1");ab("disablewbforpstn","1","2",B,"No,Yes (check on first call),Yes (check always)","0,1,2","1");ab("callback_accessnumber","","1",ar,"","","1");ab("storecallhistory","1","2",K,"Local + Native,Local,Native,No history","0,1,2,3","1");ab("keepdeviceawakeincall","2","2",K,"No,Basic only,Auto,Full then partial,Always full","0,1,2,3,4","1");ab("speakermode","0","2",B,"Auto,Never,Always","0,1,2","1");ab("focusaudio","1","2",B,"Auto guess,No,Yes","0,1,2","1");ab("useroutingapi","0","2",B,"Auto,No,Yes","0,1,2","1");ab("integrateifwifionly","false","0",ac,"","","1");ab("nativefilterallow","","1",ac,"","","1");ab("nativefilterblock","","1",ac,"","","1");ab("companyname","","-1",Z,"","","1");ab("supportpageuri","","-1",Z,"","","1");ab("proversioncallcount","0","-1",Z,"","","1");ab("magicnumber",W,"-1",Z,"","","1");ab("upgradesettfromdatabase","true","-1",Z,"","","1");ab("cfgvideo","4","2",bp,"Never,On Request,Ask,Autoaccept,Always","2,4,6,8,10","1");ab("video_profile","0","2",bp,"Auto,Low,Medium,High,Ultra,Extra","0,4,6,8,10,15","1");ab("use_h263","2","0",bp,"","","1");ab("use_h264","3","0",bp,"","","1");ab("lastautoprov","0","-1",Z,"","","1");ab("loglastusage","0","-1",Z,"","","1");ab("redial","","-1",Z,"","","1");ab("vibrate","0","2",K,"Auto,Never,Always","0,1,2","1");ab("video_fps","0","1",bp,"","","1");ab("setfinalcodec","1","2",B,"Never,Auto,On multiple codec,Always","0,1,2,3","1");ab("use_rport","1","2",aP,"No,On simmetric nat,Always,Even on public ip,Request but don't use","0,1,2,3,9","1");ab("natopenpackets","2","1",aP,"","","1");ab("video_accept_checkbox","false","-1",Z,"","","1");ab("successfulcalls","0","-1",Z,"","","1");ab("wasrated","false","-1",Z,"","","1");ab("lastratedate","0","-1",Z,"","","1");ab("hidemyidentity","false","0",aP,"","","1");ab("last_transfer_number","","-1",Z,"","","1");ab("last_conference_number","","-1",Z,"","","1");ab("last_forward_number","","-1",Z,"","","1");ab("validprovisioning","false","-1",Z,"","","1");ab("jsscriptevent","2","-1",Z,"","","1");ab("devicetype",""+a2(),"-1",Z,"","","1")}catch(bQ){g(2,"_settings: InitializeSettings",bQ)}}function ab(bQ,bS,bV,bX,bY,bR,bU){try{if(bG(bQ)){e(2,"WARNING, _settings: SettingItem invalid setting: "+bQ+", "+bS+", "+bV+", "+bX+", "+bY+", "+bR+", "+bU);return}var bW=[];bW[a0]=bS;bW[bN]=bV;bW[d]=bX;bW[bD]=bY;bW[aA]=bR;bW[aX]=bU;J[bQ]=bW}catch(bT){g(2,"common: SettingItem",bT)}}function bs(bT){var bR=0;try{if(bG(bT)||bT.length<1){bR=2;e(3,"WARNING, common: GetParameter no input param");return""}if(bG(J)||bG(J.magicnumber)){bR=8;e(2,"WARNING, CommonGUI GetParameter no settings");return""}bR=9;if(!(bT in J)){return""}var bS=J[bT];return bS[a0]}catch(bQ){g(3,"common: GetParameter ("+bR+"), parameter: "+bT,bQ)}return""}function A(bT,bR){try{if(bG(bT)||bT.length<1){e(3,"WARNING, common: SaveParameter no input param");return false}if(bG(J)){e(2,"WARNING, common: SaveParameter no settings");return false}if(!bG(bR)){bR=bR.toString()}var bS;if(bT in J){bS=J[bT];bS[a0]=bR;bS[aX]="0";J[bT]=bS;r.wasSettModified=true}else{ab(bT,bR,"-1","-1","","","1");r.wasSettModified=true}return true}catch(bQ){g(3,"common: SaveParameter",bQ)}return false}function aJ(bQ,bX){var bR=";";try{if(!bX||typeof(bX)!=="function"){e(2,"ERROR, common: SaveSettingsFile callback not defined");return false}if(bG(bQ)||bQ.length<1){e(2,"ERROR, common: SaveSettingsFile filename is NULL");return}if(bG(J)||bG(J.magicnumber)){e(2,"ERROR, common: SaveSettingsFile no setings to be saved");bX(false);return false}e(2,"EVENT, SaveSettingsFile filename: "+bQ);var bV="";var bW="";for(var bT in J){if(bG(bT)||bT.length<1){continue}var bS=J[bT];bV=bV+bT+bR+bS[a0]+bR+bS[bN]+bR+bS[d]+bR+bS[bD]+bR+bS[aA]+bR+bS[aX]+"\r\n";if(bT==="sipusername"||bT==="password"||bT==="serveraddress_user"||bT==="serveraddress_orig"||bT==="log"||bT==="upperserver"){bW=bW+bT+bR+bS[a0]+"\r\n"}}if(bG(r.File)){e(2,"EVENT, SaveSettingsFile File class is NULL");bX(false);return false}r.File.SaveFile(bQ+"_backup",bW,r.STORAGE_COOKIE,function(bY){e(3,"EVENT, SaveSettingsFile save coockie backup: "+bY.toString())});if(ah()){t(bQ,bV,function(bY){bX(true)})}else{r.File.SaveFile(bQ,bV,r.STORAGE_LOCAL,function(bY){bX(true)})}}catch(bU){g(2,"common: SaveSettingsFile",bU)}}function z(bQ,bT){e(3,"DEBUG, common ReadSettingsFile called");var bR=";";try{if(!bT||typeof(bT)!=="function"){e(2,"ERROR, common: ReadSettingsFile callback not defined");return}if(bG(bQ)||bQ.length<1){e(2,"ERROR, common: ReadSettingsFile filename is NULL");return}if(bG(r.File)){e(2,"EVENT, ReadSettingsFile File class is NULL");bT(false);return false}if(ah()){e(3,"DEBUG, common ReadSettingsFile winapi");aH(bQ,function(bU){e(3,"DEBUG, common ReadSettingsFile acllback");if(bG(bU)||aa(bU).length<1){e(3,"DEBUG, common ReadSettingsFile no content");e(2,"ERROR, common: ReadSettingsFile no content WinApi");r.File.ReadFile(bQ+"_backup",r.STORAGE_COOKIE,function(bX){if(bG(bX)||aa(bX).length<1){bT(false);return false}e(2,"READ contentfromcookie WinApi = "+ay(bX));ag();var b0=bX.split("\r\n");if(bG(b0)||b0.length<1){bT(false);return false}for(var bW=0;bW<b0.length;bW++){if(bG(b0[bW])||b0[bW].length<2||b0[bW].indexOf(";")<0){continue}var bZ=b0[bW].indexOf(bR);if(bZ<1){continue}var bV=aa(b0[bW].substring(0,bZ));var bY=aa(b0[bW].substring(bZ+1));A(bV,bY)}e(2,"WARNING, common: ReadSettingsFile important settings restored from cookie WinApi: "+bX);bT(true);return true})}if(!bG(bU)&&bU.length>2){X(bU,bT)}})}else{r.File.ReadFile(bQ,r.STORAGE_LOCAL,function(bU){if(bG(bU)||aa(bU).length<1){e(2,"ERROR, common: ReadSettingsFile no content");r.File.ReadFile(bQ+"_backup",r.STORAGE_COOKIE,function(bX){if(bG(bX)||aa(bX).length<1){bT(false);return false}e(2,"READ contentfromcookie = "+ay(bX));ag();var b0=bX.split("\r\n");if(bG(b0)||b0.length<1){bT(false);return false}for(var bW=0;bW<b0.length;bW++){if(bG(b0[bW])||b0[bW].length<2||b0[bW].indexOf(";")<0){continue}var bZ=b0[bW].indexOf(bR);if(bZ<1){continue}var bV=aa(b0[bW].substring(0,bZ));var bY=aa(b0[bW].substring(bZ+1));A(bV,bY)}e(2,"WARNING, common: ReadSettingsFile important settings restored from cookie: "+ay(bX));bT(true);return true})}X(bU,bT)})}}catch(bS){g(2,"common: ReadSettingsFile",bS)}}function X(bY,b3){e(3,"DEBUG, common ParseSettingsReadFromFile called, content: "+ay(bY));try{var b4=";";var bV=bY.split("\r\n");if(bG(bV)||bV.length<1){e(2,"ERROR, common: ReadSettingsFile empty content");b3(false);return false}if(!bG(J)){for(var b1 in J){delete J[b1]}}var bQ="";var bS="";var bZ="";var b0="";var b2="";var bR="";var bX="";e(3,"DEBUG, common ParseSettingsReadFromFile starting to parse...");for(var bU=0;bU<bV.length;bU++){if(bG(bV[bU])||bV[bU].length<2||bV[bU].indexOf(";")<0){e(2,"WARNING, common ReadSettingsFile broken or invalid setting: "+bV[bU]);continue}var bW=bV[bU].split(b4);if(bG(bW)){e(2,"WARNING, common ReadSettingsFile can't parse setting: "+bV[bU]);continue}if(bW.length!==7){e(2,"WARNING, common ReadSettingsFile broken or invalid setting after parse; length: "+bW.length);continue}bQ=bW[0];bS=bW[1];bZ=bW[2];b0=bW[3];b2=bW[4];bR=bW[5];bX=bW[6];ab(bQ,bS,bZ,b0,b2,bR,bX);bQ="";bS="";bZ="";b0="";b2="";bR="";bX=""}e(3,"DEBUG, common ParseSettingsReadFromFile finished parsing, callback to Settings page");b3(true)}catch(bT){g(2,"common: ParseSettingsReadFromFile",bT)}}function y(){try{var bS=window.location.href;if(bG(bS)||bS.length<1){return}bS=aa(bS);e(3,"EVENT, GetSettingsFromUrl url: "+bS);var bW=bS.indexOf("?");if(bW<0){return}bS=bS.substring(bW+1,bS.length);var bR=0;while(bS.length>3&&bR<5000){bR++;bW=bS.indexOf("&");if(bW<0){bW=bS.length}var bT=bS.substring(0,bW);bS=bS.substring(bW,bS.length);if(bS.indexOf("&")===0){bS=bS.substring(1,bS.length)}if(bG(bT)||bT.length<1){continue}bT=aa(bT);bW=bT.indexOf("=");if(bW<1){e(3,"EVENT, GetSettingsFromUrl invalid settings: "+bT);continue}var bQ=aa(bT.substring(0,bW));var bV=aa(bT.substring(bW+1,bT.length));if(bQ==="platform"&&bV==="windesktop"){bQ="devicetype";bV=""+bl()}A(bQ,bV);window.wphone[bQ]=bV}}catch(bU){g(2,"common: GetSettingsFromUrl",bU)}}var bj=0;var V=1;var ai=2;var a9=3;var M=4;var aj=5;var m=6;function bz(){try{if(!bG(r.maintimerid)){clearInterval(r.maintimerid)}if(!bG(r.polltimerid)){clearInterval(r.polltimerid)}if(!bG(r.initcalled)){r.initcalled=false}r.intentsettings[0]="startedfrom=app";bC.mobile.changePage("#page_settings",{transition:"pop",role:"page"})}catch(bQ){g(2,"common: OpenSettings",bQ)}}function bd(bT,bU){try{if(bG(bT)||bG(bU)){return""}bU=aa(bU);if(bT.length<1||bU.length<1){return""}for(var bR=0;bR<bT.length;bR++){if(bG(bT[bR])){continue}if(bT[bR].indexOf(bU)===0&&bT[bR].indexOf("=")>0){var bQ=bT[bR].substring(bT[bR].indexOf("=")+1);return aa(bQ)}}}catch(bS){g(2,"common: GetIntentParam",bS)}return""}function aU(bV){var bQ=";";try{if(!bV||typeof(bV)!=="function"){e(2,"ERROR, common: SaveContactsFile callback not defined");return}if(bG(r.ctlist)){e(2,"EVENT, SaveContactsFile no contacts to be saved");bV(false);return false}if(bG(r.File)){e(2,"EVENT, SaveContactsFile File class is NULL");bV(false);return false}var bU="";var bS=null;for(var bR=0;bR<r.ctlist.length;bR++){bS=r.ctlist[bR];if(bG(bS)){continue}bU=bU+bS[bj]+",[";bU=bU+bS[V].join(bQ)+"],[";bU=bU+bS[ai].join(bQ)+"],";bU=bU+bS[a9]+","+bS[M]+","+bS[aj]+","+bS[m]+"\r\n"}if(ah()){e(3,"DEBUG, SaveContactsFile ApiWinSaveFile");t(r.CONTACTS_FILENAME,bU,function(bW){e(3,"DEBUG, SaveContactsFile ApiWinSaveFile callback");r.wereCtModified=false;bV(true)})}else{r.File.SaveFile(r.CONTACTS_FILENAME,bU,r.STORAGE_LOCAL,function(bW){r.wereCtModified=false;bV(bW)})}}catch(bT){g(2,"common: SaveContactsFile",bT)}}function D(bR){e(3,"DEBUG, ReadContactsFile called");try{if(!bR||typeof(bR)!=="function"){e(2,"ERROR, common: ReadContactsFile callback not defined");return}if(bG(r.File)){e(2,"EVENT, ReadContactsFile File class is NULL");bR(false);return false}if(ah()){e(3,"DEBUG, ReadContactsFile ApiWinLoadFile called");aH(r.CONTACTS_FILENAME,function(bS){e(3,"DEBUG, ReadContactsFile ApiWinLoadFile callback: content: "+bS);if(bG(bS)||aa(bS).length<1){e(2,"ERROR, common: ReadContactsFile no content WinApi");bR(false);return false}Y(bS,bR)})}else{r.File.ReadFile(r.CONTACTS_FILENAME,r.STORAGE_LOCAL,function(bS){if(bG(bS)||aa(bS).length<1){e(2,"ERROR, common: ReadContactsFile no content");bR(false);return false}Y(bS,bR)})}}catch(bQ){g(2,"common: ReadContactsFile",bQ)}}function Y(bW,b0){try{var b1=";";var bX=bW.split("\r\n");if(bG(bX)||bX.length<1){e(2,"ERROR, common: ParseContactsReadFromFile empty content");b0(false);return false}if(!bG(r.ctlist)){for(var bY in r.ctlist){delete r.ctlist[bY]}}var bQ="";var bR="";for(var bT=0;bT<bX.length;bT++){if(bG(bX[bT])||bX[bT].length<2||bX[bT].indexOf(",")<0){e(2,"WARNING, common ParseContactsReadFromFile broken or invalid contact (1): "+bX[bT]);continue}bQ=bX[bT].split(",");bR="";bR=bQ[V];if(bG(bR)||bR.length<2||bR.indexOf("[")<0){e(2,"WARNING, common ParseContactsReadFromFile broken or invalid contact: (2)"+bX[bT]);continue}bR=bR.substring(1,bR.length-1);var bZ=bR.split(b1);if(bG(bZ)){bZ=[]}bR="";bR=bQ[ai];if(bG(bR)||bR.length<2||bR.indexOf("[")<0){e(2,"WARNING, common ParseContactsReadFromFile broken or invalid contact: (3)"+bX[bT]);continue}bR=bR.substring(1,bR.length-1);var bU=bR.split(b1);if(bG(bU)){bU=[]}var bV=[];bV[bj]=bQ[bj];bV[V]=bZ;bV[ai]=bU;bV[a9]=bQ[a9];bV[M]=bQ[M];bV[aj]=bQ[aj];bV[m]=bQ[m];r.ctlist.push(bV)}by();b0(true)}catch(bS){g(2,"common: ParseContactsReadFromFile",bS)}}function at(bR){try{if(bG(r.ctlist)||r.ctlist.length<1){D(function(bS){if(bR){bR(bS)}})}else{if(r.wasCtModified){by();if(bR){bR(true)}}else{if(bR){bR(true)}}}}catch(bQ){g(2,"common: GetContacts",bQ)}}function by(){try{r.ctlist.sort(function(bS,bR){if(bS[bj].toLowerCase()<bR[bj].toLowerCase()){return -1}if(bS[bj].toLowerCase()>bR[bj].toLowerCase()){return 1}return 0})}catch(bQ){g(2,"common: SortContacts",bQ)}}function I(bS){var bW=-1;try{if(bG(bS)||(aa(bS)).length<1||bG(r.ctlist)||r.ctlist.length<1){return -1}bS=aa(bS.replace("+",""));var bR=bS;if(bR.length>4){bR=aa(bR.substring(1))}if(bR.length>4&&bR.charAt(0)==="0"){bR=aa(bR.substring(1))}var bQ=bR;bQ=bQ.replace("-","");bQ=bQ.replace(" ","");bQ=bQ.replace("(","");bQ=bQ.replace(")","");bQ=aa(bQ);for(var bV=0;bV<r.ctlist.length;bV++){var bX=r.ctlist[bV];if(bG(bX)){continue}var bY=bX[V];if(bG(bY)){continue}for(var bU=0;bU<bY.length;bU++){if(bG(bY[bU])){continue}if(bY[bU].indexOf(bS)>-1||bY[bU].indexOf(bR)>-1||bY[bU].indexOf(bQ)>-1){bW=bV;break}}}}catch(bT){g(2,"common: GetContactIdFromNumber",bT)}return bW}function bH(bS){var bU=bS;try{if(bG(bS)||(aa(bS)).length<1){return""}if(bG(r.ctlist)||r.ctlist.length<1){return bS}bS=aa(bS.replace("+",""));var bR=bS;if(bR.length>4){bR=aa(bR.substring(1))}if(bR.length>4&&bR.charAt(0)==="0"){bR=aa(bR.substring(1))}var bQ=bR;bQ=bQ.replace("-","");bQ=bQ.replace(" ","");bQ=bQ.replace("(","");bQ=bQ.replace(")","");bQ=aa(bQ);for(var bW=0;bW<r.ctlist.length;bW++){var bX=r.ctlist[bW];if(bG(bX)){continue}var bY=bX[V];if(bG(bY)){continue}for(var bV=0;bV<bY.length;bV++){if(bG(bY[bV])){continue}if(bY[bV].indexOf(bS)>-1||bY[bV].indexOf(bR)>-1||bY[bV].indexOf(bQ)>-1){bU=bX[bj];break}}}}catch(bT){g(2,"common: GetContactNameFromNumber",bT)}return bU}var au=0;var a4=1;var bf=2;var bK=3;var o=4;var bA=5;function af(bV){var bR=";";try{if(!bV||typeof(bV)!=="function"){e(2,"ERROR, common: SaveCallhistoryFile callback not defined");return}if(bG(r.chlist)){e(2,"EVENT, SaveCallhistoryFile no contacts to be saved");bV(false);return false}if(bG(r.File)){e(2,"EVENT, SaveCallhistoryFile File class is NULL");bV(false);return false}var bQ="";var bU=null;for(var bS=0;bS<r.chlist.length;bS++){bU=r.chlist[bS];if(bG(bU)){continue}bQ=bQ+bU[au]+","+bU[a4]+","+bU[bf]+","+bU[bK]+","+bU[o]+","+bU[bA]+"\r\n"}if(ah()){t(aZ(),bQ,function(bW){r.wasChModified=false;bV(true)})}else{r.File.SaveFile(aZ(),bQ,r.STORAGE_LOCAL,function(bW){r.wasChModified=false;bV(bW)})}}catch(bT){g(2,"common: SaveCallhistoryFile",bT)}}function an(bR){try{if(!bR||typeof(bR)!=="function"){e(2,"ERROR, common: ReadCallhistoryFile callback not defined");return}if(bG(r.File)){e(2,"EVENT, ReadCallhistoryFile File class is NULL");bR(false);return false}if(ah()){aH(aZ(),function(bS){if(bG(bS)||aa(bS).length<1){e(2,"ERROR, common: ReadCallhistoryFile no content WinApi");bR(false);return false}u(bS,bR)})}else{r.File.ReadFile(aZ(),r.STORAGE_LOCAL,function(bS){if(bG(bS)||aa(bS).length<1){e(2,"ERROR, common: ReadCallhistoryFile no content");bR(false);return false}u(bS,bR)})}}catch(bQ){g(2,"common: ReadCallhistoryFile",bQ)}}function u(bV,bX){try{var bY=";";var bQ=bV.split("\r\n");if(bG(bQ)||bQ.length<1){e(2,"ERROR, common: ReadCallhistoryFile empty content");bX(false);return false}if(!bG(r.chlist)){for(var bW in r.chlist){delete r.chlist[bW]}}var bS=null;var bR="";for(var bU=0;bU<bQ.length;bU++){if(bG(bQ[bU])||bQ[bU].length<2||bQ[bU].indexOf(",")<0){e(2,"WARNING, common ReadCallhistoryFile broken or invalid contact (1): "+bQ[bU]);continue}bS=bQ[bU].split(",");if(bG(bS)||bS.length<2){e(2,"WARNING, common ReadCallhistoryFile broken or invalid contact: (2)"+bQ[bU]);continue}r.chlist.push(bS)}bX(true)}catch(bT){g(2,"common: ParseCallhistoryReadFromFile",bT)}}function aK(bU,bW,bS){try{e(4,"EVENT, StartMsg called fromclass: "+bS);bU=bm(bU);var bV="";if(r.customizedversion){var bR=bs("sms_uri");var bX=bs("chatsms");if(!bG(bR)&&bR.length>0){if(bX==="1"){bV="sms";bJ(bU,bW,bV,bS)}else{if(bX==="2"){bV="chat";bJ(bU,bW,bV,bS)}else{if(bX==="0"){var bQ=bU;if(bQ.indexOf("+")>=0){bQ=bQ.substring(bQ.indexOf("+")+1,bQ.length)}if(!bQ.match("^[0-9 ]{6,20}$")){bV="chat";bJ(bU,bW,bV,bS)}else{bv(bU,bW)}}}}}else{bV="chat";bJ(bU,bW,bV,bS)}}else{bV="chat";bJ(bU,bW,bV,bS)}}catch(bT){g(2,"common: StartMsg",bT)}}function bv(bT,bQ,bV,bY){try{var bW=k();if(!bG(bW)&&bi(bW)&&bW>100){bW=Math.floor(bW/1.2)}else{bW=220}var bU="";var b0='<li id="[ITEMID]"><a data-rel="back">[ITEMTITLE]</a></li>';var bX="";bX=b0.replace("[ITEMID]","#item_chat");bX=bX.replace("[ITEMTITLE]",a3.get("chat"));bU=bU+bX;bX="";bX=b0.replace("[ITEMID]","#item_sms");bX=bX.replace("[ITEMTITLE]",a3.get("sms"));bU=bU+bX;bX="";var bZ='<div id="chatsms_popup" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+bW+"px; min-width: "+Math.floor(bW*0.6)+'px;"><div data-role="header" data-theme="b"><a href="#" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+a3.get("chat_sms_title")+'</h1></div><div role="main" class="ui-content adialog_content" style="padding: 0; margin: 0;"><ul id="chatsms_ul" data-role="listview" data-inset="true" data-icon="false" style="margin: 0;">'+bU+'</ul></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="#" style="width: 98%;" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+a3.get("btn_close")+"</a></div></div>";bY=bY?bY:function(){};bC.mobile.activePage.append(bZ).trigger("create");bC.mobile.activePage.find(".closePopup").bind("tap",function(b1){bC.mobile.activePage.find(".messagePopup").popup("close")});bC.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){bC(this).unbind("popupafterclose").remove();bC("#chatsms_ul").off("click","li");bY()}});var bS="";bC("#chatsms_ul").on("click","li",function(b1){var b2=bC(this).attr("id");if(b2==="#item_chat"){bS="chat"}if(b2==="#item_sms"){bS="sms"}bC("#chatsms_popup").on("popupafterclose",function(b3){bC("#chatsms_popup").off("popupafterclose");bJ(bT,bQ,bS,bV)})})}catch(bR){g(2,"common: ChooseChatOrSms",bR)}}function bJ(bT,bV,bU,bR){try{if(bR!=="_messagelist"&&(bG(bT)||bT.length<1)){var bQ=bs("messagefiles");if(bG(bQ)||bQ.length<3){if(bG(bV)){bV=""}r.intentmsg[0]="action="+bU;r.intentmsg[1]="to="+bT;r.intentmsg[2]="message="+bV;bC.mobile.changePage("#page_message",{transition:"slide",role:"page"})}else{bC.mobile.changePage("#page_messagelist",{transition:"none",role:"page"})}}else{if(bG(bV)){bV=""}r.intentmsg[0]="action="+bU;r.intentmsg[1]="to="+bT;r.intentmsg[2]="message="+bV;bC.mobile.changePage("#page_message",{transition:"slide",role:"page"})}}catch(bS){g(2,"common: StartMsgActivity",bS)}}function L(bS,bW){try{if(bG(bS)||bS.length<3){e(2,"WARNING, common OpenWebURL no url passed");return}var bQ=bs("sipusername");var bT=bs("password");var bV="";var bR="";if(a3.get("brandname")===a3.get("brand_mizu")){bV=a8("C8y5:"+bQ+":"+bT+":8294032567")}bS=aa(bS);bS=bS.replace("[USERNAME]",bQ);bS=bS.replace("[PASSWORD]",bT);bS=bS.replace("[MD5AUTH]",bV);bS=bS.replace("[SHA1HASH]",bR);e(3,"EVENT, OpenWebURL = "+bS);r.intentbrowser[0]="url="+bS;r.intentbrowser[1]="lastpage="+bC.mobile.activePage.attr("id");if(bG(bW)){bW=""}r.intentbrowser[2]="title="+bW;bC.mobile.changePage("#page_internalbrowser",{transition:"pop",role:"page"})}catch(bU){g(2,"common: OpenWebURL",bU)}}function a8(bQ){var bS="";try{if(bG(bQ)||(aa(bQ)).length<1){e(2,"WARNING, common: Md5Hash string to hash is NULL");return""}bS=aY(bQ);if(bG(bS)){bS=""}return bS}catch(bR){g(2,"common: Md5Hash",bR)}return""}function aY(bT){try{function bS(b6,b8){var b7=b6[0],b5=b6[1],ca=b6[2],b9=b6[3];b7=bQ(b7,b5,ca,b9,b8[0],7,-680876936);b9=bQ(b9,b7,b5,ca,b8[1],12,-389564586);ca=bQ(ca,b9,b7,b5,b8[2],17,606105819);b5=bQ(b5,ca,b9,b7,b8[3],22,-1044525330);b7=bQ(b7,b5,ca,b9,b8[4],7,-176418897);b9=bQ(b9,b7,b5,ca,b8[5],12,1200080426);ca=bQ(ca,b9,b7,b5,b8[6],17,-1473231341);b5=bQ(b5,ca,b9,b7,b8[7],22,-45705983);b7=bQ(b7,b5,ca,b9,b8[8],7,1770035416);b9=bQ(b9,b7,b5,ca,b8[9],12,-1958414417);ca=bQ(ca,b9,b7,b5,b8[10],17,-42063);b5=bQ(b5,ca,b9,b7,b8[11],22,-1990404162);b7=bQ(b7,b5,ca,b9,b8[12],7,1804603682);b9=bQ(b9,b7,b5,ca,b8[13],12,-40341101);ca=bQ(ca,b9,b7,b5,b8[14],17,-1502002290);b5=bQ(b5,ca,b9,b7,b8[15],22,1236535329);b7=b0(b7,b5,ca,b9,b8[1],5,-165796510);b9=b0(b9,b7,b5,ca,b8[6],9,-1069501632);ca=b0(ca,b9,b7,b5,b8[11],14,643717713);b5=b0(b5,ca,b9,b7,b8[0],20,-373897302);b7=b0(b7,b5,ca,b9,b8[5],5,-701558691);b9=b0(b9,b7,b5,ca,b8[10],9,38016083);ca=b0(ca,b9,b7,b5,b8[15],14,-660478335);b5=b0(b5,ca,b9,b7,b8[4],20,-405537848);b7=b0(b7,b5,ca,b9,b8[9],5,568446438);b9=b0(b9,b7,b5,ca,b8[14],9,-1019803690);ca=b0(ca,b9,b7,b5,b8[3],14,-187363961);b5=b0(b5,ca,b9,b7,b8[8],20,1163531501);b7=b0(b7,b5,ca,b9,b8[13],5,-1444681467);b9=b0(b9,b7,b5,ca,b8[2],9,-51403784);ca=b0(ca,b9,b7,b5,b8[7],14,1735328473);b5=b0(b5,ca,b9,b7,b8[12],20,-1926607734);b7=bV(b7,b5,ca,b9,b8[5],4,-378558);b9=bV(b9,b7,b5,ca,b8[8],11,-2022574463);ca=bV(ca,b9,b7,b5,b8[11],16,1839030562);b5=bV(b5,ca,b9,b7,b8[14],23,-35309556);b7=bV(b7,b5,ca,b9,b8[1],4,-1530992060);b9=bV(b9,b7,b5,ca,b8[4],11,1272893353);ca=bV(ca,b9,b7,b5,b8[7],16,-155497632);b5=bV(b5,ca,b9,b7,b8[10],23,-1094730640);b7=bV(b7,b5,ca,b9,b8[13],4,681279174);b9=bV(b9,b7,b5,ca,b8[0],11,-358537222);ca=bV(ca,b9,b7,b5,b8[3],16,-722521979);b5=bV(b5,ca,b9,b7,b8[6],23,76029189);b7=bV(b7,b5,ca,b9,b8[9],4,-640364487);b9=bV(b9,b7,b5,ca,b8[12],11,-421815835);ca=bV(ca,b9,b7,b5,b8[15],16,530742520);b5=bV(b5,ca,b9,b7,b8[2],23,-995338651);b7=b3(b7,b5,ca,b9,b8[0],6,-198630844);b9=b3(b9,b7,b5,ca,b8[7],10,1126891415);ca=b3(ca,b9,b7,b5,b8[14],15,-1416354905);b5=b3(b5,ca,b9,b7,b8[5],21,-57434055);b7=b3(b7,b5,ca,b9,b8[12],6,1700485571);b9=b3(b9,b7,b5,ca,b8[3],10,-1894986606);ca=b3(ca,b9,b7,b5,b8[10],15,-1051523);b5=b3(b5,ca,b9,b7,b8[1],21,-2054922799);b7=b3(b7,b5,ca,b9,b8[8],6,1873313359);b9=b3(b9,b7,b5,ca,b8[15],10,-30611744);ca=b3(ca,b9,b7,b5,b8[6],15,-1560198380);b5=b3(b5,ca,b9,b7,b8[13],21,1309151649);b7=b3(b7,b5,ca,b9,b8[4],6,-145523070);b9=b3(b9,b7,b5,ca,b8[11],10,-1120210379);ca=b3(ca,b9,b7,b5,b8[2],15,718787259);b5=b3(b5,ca,b9,b7,b8[9],21,-343485551);b6[0]=bU(b7,b6[0]);b6[1]=bU(b5,b6[1]);b6[2]=bU(ca,b6[2]);b6[3]=bU(b9,b6[3])}function b2(ca,b7,b6,b5,b9,b8){b7=bU(bU(b7,ca),bU(b5,b8));return bU((b7<<b9)|(b7>>>(32-b9)),b6)}function bQ(b7,b6,cb,ca,b5,b9,b8){return b2((b6&cb)|((~b6)&ca),b7,b6,b5,b9,b8)}function b0(b7,b6,cb,ca,b5,b9,b8){return b2((b6&ca)|(cb&(~ca)),b7,b6,b5,b9,b8)}function bV(b7,b6,cb,ca,b5,b9,b8){return b2(b6^cb^ca,b7,b6,b5,b9,b8)}function b3(b7,b6,cb,ca,b5,b9,b8){return b2(cb^(b6|(~ca)),b7,b6,b5,b9,b8)}function b1(b7){txt="";var b9=b7.length,b8=[1732584193,-271733879,-1732584194,271733878],b6;for(b6=64;b6<=b7.length;b6+=64){bS(b8,b4(b7.substring(b6-64,b6)))}b7=b7.substring(b6-64);var b5=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b6=0;b6<b7.length;b6++){b5[b6>>2]|=b7.charCodeAt(b6)<<((b6%4)<<3)}b5[b6>>2]|=128<<((b6%4)<<3);if(b6>55){bS(b8,b5);for(b6=0;b6<16;b6++){b5[b6]=0}}b5[14]=b9*8;bS(b8,b5);return b8}function b4(b6){var b7=[],b5;for(b5=0;b5<64;b5+=4){b7[b5>>2]=b6.charCodeAt(b5)+(b6.charCodeAt(b5+1)<<8)+(b6.charCodeAt(b5+2)<<16)+(b6.charCodeAt(b5+3)<<24)}return b7}var bZ="0123456789abcdef".split("");function bX(b7){var b6="",b5=0;for(;b5<4;b5++){b6+=bZ[(b7>>(b5*8+4))&15]+bZ[(b7>>(b5*8))&15]}return b6}function bR(b5){for(var b6=0;b6<b5.length;b6++){b5[b6]=bX(b5[b6])}return b5.join("")}function bY(b5){return bR(b1(b5))}function bU(b6,b5){return(b6+b5)&4294967295}if(bY("hello")!="5d41402abc4b2a76b9719d911017c592"){function bU(b5,b8){var b7=(b5&65535)+(b8&65535),b6=(b5>>16)+(b8>>16)+(b7>>16);return(b6<<16)|(b7&65535)}}return bY(bT)}catch(bW){g(2,"common: Md5Lib",bW)}return""}function aG(bS,bY,bX,bW,bV,bU){try{if(bG(bS)||(aa(bS)).length<1){e(2,"ERROR, common: UriParser uri is NULL");return}var b0=bs("sipusername");var bR=bs("password");var bQ=a8(bR);var bZ="";e(3,"EVENT, uri = "+bS);bS=aa(bS);bS=bS.replace("[USERNAME]",b0);bS=bS.replace("[PASSWORD]",bR);bS=bS.replace("[MD5AUTH]",bQ);bS=bS.replace("[PIN]",bY);bS=bS.replace("[ANUM]",bX);bS=bS.replace("[BNUM]",bW);bS=bS.replace("[TXT]",bV);bS=bS.replace("[SHA1HASH]",bZ);e(5,"EVENT,httpRequestUri = "+bS+";   action = "+bU);G(bS,bU,false)}catch(bT){g(2,"common: UriParser",bT)}}function G(bT,bV,bW){var bU=0;var bR="get";try{if(!bG(bW)&&bW===true){bR="post"}bU=1;bC.getJSON("http://whateverorigin.org/get?url="+encodeURIComponent(bT)+"&callback=?",function(bX){p(bX,bV)});bU=2}catch(bS){g(2,"common: HttpRequest ("+bU.toString()+")",bS);try{if(bV==="creditrequest"){if(r.creditRequestIval<30000){r.creditRequestIval=r.creditRequestIval*2}else{r.creditRequestIval=1800}}}catch(bQ){}}}function p(bR,bU){try{if(bG(bR)||bG(bR.contents)){e(3,"ERROR, common: httpResponse is NULL");return}var bT=bR.contents;var bV="";if(bT.length>600){bV=bT.substring(0,600)+" ..."}else{bV=bT}e(3,"EVENT, common: httpResponse: "+bV);if(bG(bU)||(aa(bU)).length<1){e(2,"ERROR, common: HttpResponseHandler action is NULL");return}if(bU==="creditrequest"){var bX=bT.toLowerCase();if(bX.indexOf("error")>=0||bX.indexOf("postpaid")>=0){if(r.creditRequestIval<30000){r.creditRequestIval=r.creditRequestIval*2}else{r.creditRequestIval=1800}}else{var bW="";r.credit=bW+bT;if(r.credit.indexOf("Your credit is")>=0){r.credit=r.credit.replace("Your credit is","Credit:")}}}if(bU==="ratingrequest"){if((bT.toLowerCase()).indexOf("error")>=0){e(2,"ERROR, HttpResponseHandler action: Call, error: "+bT);return}var bQ=bT;r.rating=" ("+bQ+a3.get("rating_minute")+")"}if(bU==="newuserreg"){if((bT.toLowerCase()).indexOf("error")>=0){e(2,"ERROR, HttpResponseHandler action: newuserreg, error: "+bT);return}bq(bT)}if(bU==="phone2phone"){if((bT.toLowerCase()).indexOf("error")>=0){e(2,"ERROR, HttpResponseHandler action: phone2phone, error: "+bT);return}bq(bT)}if(bU==="callback"){if((bT.toLowerCase()).indexOf("error")>=0){e(2,"ERROR, HttpResponseHandler action: callback, error: "+bT);return}bq(bT)}}catch(bS){g(2,"common: HttpResponseHandler",bS)}}function aQ(bQ,bU,bW){try{if(bG(bW)){bW=true}if(bG(bU)){e(2,"ERROR, common: PutNotifications number is NULL");return}var bV=bs("call_notifications");var bR=bs("message_notifications");if(bG(bV)){bV=""}else{bV=aa(bV)}if(bG(bR)){bR=""}else{bR=aa(bR)}if(bW){if(bV.length>2){if(bi(bV.charAt(0))){var bT=bb(bV.charAt(0));bV=bV.replace(bT.toString(),(bT+1).toString())}else{bV="2 "+a3.get("calls")}}else{bV=a3.get("call_from")+": "+bQ+", "+bU}}else{if(bR.length>2){if(bi(bR.charAt(0))){var bT=bb(bR.charAt(0));bR=bR.replace(bT.toString(),(bT+1).toString())}else{bR="2 "+a3.get("messages")}}else{bR=a3.get("message_from")+": "+bQ+", "+bU}}A("call_notifications",bV);A("message_notifications",bR);br()}catch(bS){g(2,"common: PutNotifications",bS)}}function br(){try{var bT=bs("call_notifications");var bR=bs("message_notifications");var bQ="";if(!bG(bT)&&bT.length>2){bQ=bT+"<br>"}bQ=bQ+bR;e(2,"ShowNotifications: "+bQ);bC("#dialpad_notification").html(bQ);bC("#contactslist_notification").html(bQ);bC("#callhistorylist_notification").html(bQ);bC("#messagelist_notification").html(bQ);if(!bG(bQ)&&bQ.length>2){bC("#msglist_title").hide();bC("#messagelist_notification").show();bC("#ctlist_title").hide();bC("#contactslist_notification").show();bC("#chlist_title").hide();bC("#callhistorylist_notification").show();bC("#dialpad_title").hide();bC("#dialpad_notification").show()}else{bC("#msglist_title").show();bC("#messagelist_notification").hide();bC("#ctlist_title").show();bC("#contactslist_notification").hide();bC("#chlist_title").show();bC("#callhistorylist_notification").hide();bC("#dialpad_title").show();bC("#dialpad_notification").hide()}}catch(bS){g(2,"common: ShowNotifications",bS)}}function bg(){try{A("call_notifications","");var bQ=bs("message_notifications");bC("#dialpad_notification").html(bQ);bC("#contactslist_notification").html(bQ);bC("#callhistorylist_notification").html(bQ);bC("#messagelist_notification").html(bQ);if(!bG(bQ)&&bQ.length>2){bC("#msglist_title").hide();bC("#messagelist_notification").show();bC("#ctlist_title").hide();bC("#contactslist_notification").show();bC("#chlist_title").hide();bC("#callhistorylist_notification").show();bC("#dialpad_title").hide();bC("#dialpad_notification").show()}else{bC("#msglist_title").show();bC("#messagelist_notification").hide();bC("#ctlist_title").show();bC("#contactslist_notification").hide();bC("#chlist_title").show();bC("#callhistorylist_notification").hide();bC("#dialpad_title").show();bC("#dialpad_notification").hide()}}catch(bR){g(2,"common: HideCallNotifications",bR)}}function aE(){try{A("message_notifications","");var bR=bs("call_notifications");bC("#dialpad_notification").html(bR);bC("#contactslist_notification").html(bR);bC("#callhistorylist_notification").html(bR);bC("#messagelist_notification").html(bR);if(!bG(bR)&&bR.length>2){bC("#msglist_title").hide();bC("#messagelist_notification").show();bC("#ctlist_title").hide();bC("#contactslist_notification").show();bC("#chlist_title").hide();bC("#callhistorylist_notification").show();bC("#dialpad_title").hide();bC("#dialpad_notification").show()}else{bC("#msglist_title").show();bC("#messagelist_notification").hide();bC("#ctlist_title").show();bC("#contactslist_notification").hide();bC("#chlist_title").show();bC("#callhistorylist_notification").hide();bC("#dialpad_title").show();bC("#dialpad_notification").hide()}}catch(bQ){g(2,"common: HideMessageNotifications",bQ)}}function aM(){try{A("call_notifications","");A("message_notifications","");bC("#dialpad_notification").html("");bC("#contactslist_notification").html("");bC("#callhistorylist_notification").html("");bC("#messagelist_notification").html("");bC("#msglist_title").show();bC("#messagelist_notification").hide();bC("#ctlist_title").show();bC("#contactslist_notification").hide();bC("#chlist_title").show();bC("#callhistorylist_notification").hide();bC("#dialpad_title").show();bC("#dialpad_notification").hide()}catch(bQ){g(2,"common: HideAllNotifications",bQ)}}function bk(bW){try{var bQ=bs("call_notifications");var bV=bs("message_notifications");if(bG(bQ)){bQ=""}if(bG(bV)){bV=""}if(bQ.length<2&&bV.length<2){return}else{if(bQ.length>2&&bV.length<2){bC.mobile.changePage("#page_callhistorylist",{transition:"none",role:"page"})}else{if(bQ.length<2&&bV.length>2){bC.mobile.changePage("#page_messagelist",{transition:"none",role:"page"})}else{var bT=k();if(!bG(bT)&&bi(bT)&&bT>100){bT=Math.floor(bT/1.2)}else{bT=220}var bS="";var bY='<li id="[ITEMID]"><a data-rel="back">[ITEMTITLE]</a></li>';var bU="";bU=bY.replace("[ITEMID]","#item_call_history");bU=bU.replace("[ITEMTITLE]",a3.get("callhistory"));bS=bS+bU;bU="";bU=bY.replace("[ITEMID]","#item_message_history");bU=bU.replace("[ITEMTITLE]",a3.get("messagehistory"));bS=bS+bU;bU="";var bX='<div id="notification_popup" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+bT+"px; min-width: "+Math.floor(bT*0.6)+'px;"><div data-role="header" data-theme="b"><a href="#" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+a3.get("goto")+'</h1></div><div role="main" class="ui-content adialog_content" style="padding: 0; margin: 0;"><ul id="notifications_ul" data-role="listview" data-inset="true" data-icon="false" style="margin: 0;">'+bS+'</ul></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="#" style="width: 98%;" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+a3.get("btn_close")+"</a></div></div>";bW=bW?bW:function(){};bC.mobile.activePage.append(bX).trigger("create");bC.mobile.activePage.find(".closePopup").bind("tap",function(bZ){bC.mobile.activePage.find(".messagePopup").popup("close")});bC.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){bC(this).unbind("popupafterclose").remove();bC("#notifications_ul").off("click","li");bW()}});bC("#notifications_ul").on("click","li",function(bZ){var b0=bC(this).attr("id");bC("#notification_popup").on("popupafterclose",function(b1){bC("#notification_popup").off("popupafterclose");if(b0==="#item_call_history"){bC.mobile.changePage("#page_callhistorylist",{transition:"none",role:"page"})}else{if(b0==="#item_message_history"){bC.mobile.changePage("#page_messagelist",{transition:"none",role:"page"})}}})})}}}}catch(bR){g(2,"common: NotificationOnClick",bR)}}var ae=false;var aB=3000;function bn(bQ,bX,bU,bW){var bT=0;try{var bV="";if(!bG(bU)){if(bU.length>300){bV=bU.substring(0,300)+"...."}else{bV=bU}}e(2,"EVENT, WinSoftphoneHttpReq called "+bX+" url: "+bQ+"; data: "+bV);if(bG(bX)||bX.length<1){bT=1;e(2,"WARNING, common: WinSoftphoneHttpReq: method not specified; fallback to GET");bX="GET"}bT=2;if(bG(bU)){bT=3;e(2,"ERROR, common: WinSoftphoneHttpReq: data is NULL ");ae=true;bW(null);return""}bT=4;if(bU.indexOf("API_CallEOFLINE")>=0){isreqApicall=true}bT=5;setTimeout(function(){bT=6;if(ae===false){bT=7;e(2,"ERROR, common: WinSoftphoneHttpReq: manual Timeout");bW(null);return""}},aB+1000);var bR;if(window.XMLHttpRequest){bT=8;bR=new XMLHttpRequest()}else{bT=9;bR=new ActiveXObject("Microsoft.XMLHTTP")}if(bX.toLowerCase()==="get"){bT=10;bR.open("GET",bQ+bU,true)}else{bR.open("POST",bQ,true);bT=11}bR.onreadystatechange=function(){try{e(4,"WinSoftphoneHttpReq: xmlhttp.readyState: "+bR.readyState+";  xmlhttp.status: "+bR.status);bT=19;if(bR.readyState==4&&bR.status==200){var b2=bR.responseText;var b3="";if(!bG(b2)&&b2.length>250){b3=b2.substring(0,250)+"...."}else{b3=b2}e(2,"EVENT, WinSoftphoneHttpReq response: "+b3);ae=true;if(bG(b2)||b2.length<1){bW(null);return""}else{if(b2.indexOf("APIREQUEST:")>=0){var b1="";var bZ="";if(b2.indexOf("APIRESULT:")>0){b1=b2.substring(b2.indexOf("APIREQUEST:")+11,b2.indexOf("APIRESULT:"));bZ=b2.substring(b2.indexOf("APIRESULT:")+10,b2.length)}if(bG(b1)){b1=""}else{b1=aa(b1);b1=b1.toLowerCase()}if(bG(bZ)){bZ=""}else{bZ=aa(bZ)}if(b1==="api_poll"){webphonetojs(bZ)}else{if(bZ.indexOf("ERROR")>=0){if(b1==="api_call"){var bY=bZ.replace("ERROR","");bY=bY.replace(":","");e(1,"ERROR, "+bY)}else{e(2,"ERROR, "+bZ)}bW(null);return""}else{if(bZ.toLowerCase()==="true"){bW(true);return true}else{if(bZ.toLowerCase()==="false"){bW(false);return false}else{if(bi(bZ)){bW(bb(bZ));return bb(bZ)}else{if(bZ.indexOf("OK")>=0){bT=22;bW(true);return true}else{bW(bZ);return bZ}}}}}}}else{bW(bZ);return bZ}}}}catch(b0){g(2,"common: WinSoftphoneHttpReq inner_1 ("+bT+")",b0)}};bR.timeout=aB;bR.ontimeout=function(){bT=23;e(2,"ERROR, common: WinSoftphoneHttpReq: Timeout");ae=true;bW(null);return""};if(bX.toLowerCase()==="get"){if(bU.length>0){bU="?"+bU}bT=30;bR.send()}else{bT=31;bR.send(bU)}}catch(bS){g(2,"common: WinSoftphoneHttpReq ("+bT+")",bS)}}function bx(b3,b2,bV,bU,bT,bS,bQ,b4){var bZ="BOFCOMMAND";var b0="EOFCOMMAND";var b1="BOFLINE";var bY="EOFLINE";try{if(!b2||typeof(b2)!=="function"){b2=function(b5){e(2,"EVENT, common: WinAPI NO callback specified; result: "+b5)}}if(bG(b3)||b3.length<1){e(2,"ERROR, common: WinAPI: apiname is NULL");b2(false);return false}var bW=bZ;bW=bW+b1+"function="+b3+bY;if(!bG(bV)&&(bV.toString()).length>0){bV=aa(bV);bW=bW+b1+"param1="+bV+bY}if(!bG(bU)&&(bU.toString()).length>0){bU=aa(bU);bW=bW+b1+"param2="+bU+bY}if(!bG(bT)&&(bT.toString()).length>0){bT=aa(bT);bW=bW+b1+"param3="+bT+bY}if(!bG(bS)&&(bS.toString()).length>0){bS=aa(bS);bW=bW+b1+"param4="+bS+bY}if(!bG(bQ)&&(bQ.toString()).length>0){bQ=aa(bQ);bW=bW+b1+"param5="+bQ+bY}if(!bG(b4)&&(b4.toString()).length>0){b4=aa(b4);bW=bW+b1+"param6="+b4+bY}bW=bW+b0;var bR=r.WIN_SOFTPHONE_URL;bn(bR,"POST","data="+bW,function(b5){b2(b5);return b5})}catch(bX){g(2,"common: WinAPI",bX)}}function t(bR,bV,bW){try{var bT="BOFFILE";var bQ="EOFFILE";if(!bW||typeof(bW)!=="function"){e(2,"ERROR, common: ApiWinSaveFile callback not defined");return false}if(bG(bR)||bR.length<1){e(2,"ERROR, common: ApiWinSaveFile: filename is NULL");bW(false);return false}if(bG(bV)){e(2,"ERROR, common: ApiWinSaveFile: content is NULL");bW(false);return false}bV=bT+bV+bQ;bR=aa(bR);var bS=r.WIN_SOFTPHONE_URL+"?extcmd_savedata="+bR;bn(bS,"POST","data="+bV,function(bX){bW(bX);return bX})}catch(bU){g(2,"common: ApiWinSaveFile",bU)}}function aH(bR,bV){e(3,"DEBUG, common ApiWinLoadFile called");try{var bT="BOFFILE";var bQ="EOFFILE";if(!bV||typeof(bV)!=="function"){e(2,"ERROR, common: ApiWinLoadFile callback not defined");return false}if(bG(bR)||bR.length<1){e(2,"ERROR, common: ApiWinLoadFile: filename is NULL");bV(null);return false}bR=aa(bR);var bS=r.WIN_SOFTPHONE_URL+"?extcmd_loaddata="+bR;bn(bS,"GET","",function(bW){bV(bW);return bW})}catch(bU){g(2,"common: ApiWinLoadFile",bU)}}var bE=0;function bu(bQ,bX,bZ,bU){try{var bR="BOFFILE";var bV="EOFFILE";var bY="EOFCOMMAND";if(!bZ||typeof(bZ)!=="function"){e(2,"ERROR, common: ApiWinSaveFileNew callback not defined");return false}var bW=document.getElementById("EXTERNREQUESTELEM");if(bG(bW)){e(2,"ERROR, common: ApiWinSaveFileNew: html element: EXTERNREQUESTELEM is NULL");bZ(false);return false}if(bG(bQ)||bQ.length<1){e(2,"ERROR, common: ApiWinSaveFileNew: filename is NULL");bZ(false);return false}if(bG(bX)){e(2,"ERROR, common: ApiWinSaveFileNew: content is NULL");bZ(false);return false}bX=bR+bX+bV+bY;bQ=aa(bQ);var bS="";if(!bG(bU)&&bU.length>0){bS=bU}else{bS="extcmd_savedata="+bQ}r.bwanswerINCNUMBER++;bS=bS+"&now="+r.bwanswerINCNUMBER.toString()+"\r\n";e(2,"EVENT, common: ApiWinSaveFileNew cmd: "+bS);var b0=bS+encodeURIComponent(bX);e(2,"EVENT, common: ApiWinSaveFileNew encoded: "+b0);bW.innerHTML=b0;bZ(true);return true}catch(bT){g(2,"common: ApiWinSaveFileNew",bT)}}var ba="";function aS(bR){try{e(2,"ERROR, bwanswer called; answer: "+bR);if(r.bwanswercallback&&typeof(r.bwanswercallback)==="function"){if(bG(bR)||bR.length<1||bR.indexOf("ERROR")>=0){r.bwanswercallback(null);r.bwanswercallback=null}else{if((bR.length>100||ba.length>10)){ba=ba=bR;if(ba.indexOf("EOFFILE")){var bS=decodeURIComponent(ba);r.bwanswercallback(bS);r.bwanswercallback=null}}else{var bS=decodeURIComponent(bR);r.bwanswercallback(bS);r.bwanswercallback=null}}}else{e(2,"ERROR, bwanswer: bwanswercallback is NULL")}}catch(bQ){g(2,"common: bwanswer",bQ)}}function aR(bR,bX){e(3,"DEBUG, common ApiWinLoadFileNew called");try{var bT="BOFFILE";var bQ="EOFFILE";var bW="EOFCOMMAND";if(!bX||typeof(bX)!=="function"){e(2,"ERROR, common: ApiWinLoadFileNew callback not defined");return false}var bS=document.getElementById("EXTERNREQUESTELEM");if(bG(bS)){e(2,"ERROR, common: ApiWinLoadFileNew: html element: EXTERNREQUESTELEM is NULL");bX(false);return false}if(bG(bR)||bR.length<1){e(2,"ERROR, common: ApiWinLoadFileNew: filename is NULL");bX(null);return false}bR=aa(bR);r.bwanswerINCNUMBER++;var bV="extcmd_loaddata="+bR+"&now="+r.bwanswerINCNUMBER.toString()+"\r\n";e(2,"EVENT, common: ApiWinLoadFileNew cmd: "+bV+bW);r.bwanswercallback=bX;bS.innerHTML=bV+bW;e(2,"EVENT, common: ApiWinLoadFileNew  element.innerHTML: "+bS.innerHTML)}catch(bU){g(2,"common: ApiWinLoadFileNew",bU)}}function f(){var bQ=r.WIN_SOFTPHONE_URL+"?extcmd_exit=true";bn(bQ,"GET","",function(bR){e(2,"EVENT, common: Exit response: "+bR)})}function S(){try{if(bC.mobile.activePage.attr("id")==="page_dialpad"){bC("#btn_call").click()}return true}catch(bQ){g(2,"common: EnterKeyPress",bQ)}return false}var am=0;var aq=1;var a6=2;var bw=3;var av=4;function bI(bW){var bS=";";try{if(!bW||typeof(bW)!=="function"){e(2,"ERROR, common: SaveAccountsFile callback not defined");return}var bQ=r.ACCOUNTS_FILENAME;if(bG(r.aclist)){e(2,"EVENT, SaveAccountsFile no accounts to be saved");bW(false);return false}if(bG(r.File)){e(2,"EVENT, SaveAccountsFile File class is NULL");bW(false);return false}var bV="";var bR=null;for(var bT=0;bT<r.aclist.length;bT++){bR=r.aclist[bT];if(bG(bR)){continue}bV=bV+bR[am]+","+bR[aq]+","+bR[a6]+","+bR[bw]+","+bR[av]+"\r\n"}e(2,"acfile = "+bV);if(ah()){t(bQ,bV,function(bX){bW(true)})}r.File.SaveFile(bQ,bV,r.STORAGE_LOCAL,function(bX){bW(bX)})}catch(bU){g(2,"common: SaveAccountsFile",bU)}}function aw(bS){e(3,"DEBUG, common ReadAccountsFile called");try{if(!bS||typeof(bS)!=="function"){e(2,"ERROR, common: ReadAccountsFile callback not defined");return}var bQ=r.ACCOUNTS_FILENAME;if(bG(r.File)){e(2,"EVENT, ReadAccountsFile File class is NULL");bS(false);return false}if(ah()){e(3,"DEBUG, common ReadAccountsFile winapi");aH(bQ,function(bT){e(3,"DEBUG, common ReadAccountsFile callback");if(bG(bT)||aa(bT).length<1){e(3,"DEBUG, common ReadAccountsFile content is null");e(2,"ERROR, common: ReadAccountsFile no content WinApi");r.File.ReadFile(bQ,r.STORAGE_LOCAL,function(bU){if(bG(bU)||aa(bU).length<1){e(2,"ERROR, common: ReadAccountsFile no content");bS(false);return false}aT(bU,bS)})}else{aT(bT,bS)}})}else{r.File.ReadFile(bQ,r.STORAGE_LOCAL,function(bT){if(bG(bT)||aa(bT).length<1){e(2,"ERROR, common: ReadAccountsFile no content");bS(false);return false}aT(bT,bS)})}}catch(bR){g(2,"common: ReadAccountsFile",bR)}}function aT(bW,bX){e(3,"DEBUG, common ParseAccountsReadFromFile called, content: "+bW);try{var bR=";";var bV=bW.split("\r\n");if(bG(bV)||bV.length<1){e(3,"DEBUG, common ParseAccountsReadFromFile content is null");e(2,"ERROR, common: ParseAccountsReadFromFile empty content");bX(false);return false}if(!bG(r.aclist)){for(var bT in r.aclist){delete r.aclist[bT]}}for(var bS=0;bS<bV.length;bS++){if(bG(bV[bS])||bV[bS].length<2||bV[bS].indexOf(",")<0){e(2,"WARNING, common ParseAccountsReadFromFile broken or invalid account (1): "+bV[bS]);continue}var bQ=bV[bS].split(",");r.aclist.push(bQ)}e(3,"DEBUG, common ParseAccountsReadFromFile accounts retrieved successfully");bX(true);return true}catch(bU){g(2,"common: ParseAccountsReadFromFile",bU)}}function bP(){try{if(bG(r.aclist)||r.aclist.length<1){e(2,"WARNING, common GetActiveAccount no available accounts");return null}for(var bR=0;bR<r.aclist.length;bR++){if(bG(r.aclist[bR])||r.aclist[bR].length<2){continue}var bQ=r.aclist[bR];if(bQ[av]==="true"){return bQ}}}catch(bS){g(2,"common: GetActiveAccount",bS)}return null}function aW(){try{var bQ=bP();if(bG(bQ)||bQ.length<2){e(2,"ERROR, common GetActiveAccSettingsFilename cant get filename");return""}if(bG(bQ[a6])||(bQ[a6]).length<1){e(2,"ERROR, common GetActiveAccSettingsFilename no filename");return""}return bQ[a6]}catch(bR){g(2,"common: GetActiveAccount",bR)}return""}function aZ(){try{var bQ=aW();if(bG(bQ)||bQ.length<1){return""}return bQ+"_ch"}catch(bR){g(2,"common: GetActiveAccCallhistoryFilename",bR)}return""}var ap="aJ6aqK4Nah3hnP7aht";function aF(bW,bZ){try{if(bG(bZ)||bZ.length<1||bG(bW)){e(2,"ERROR, file: common no key or value");return null}var b1="";for(var bT=0;bT<bZ.length;bT++){b1+=bZ.charCodeAt(bT).toString()}var bX=Math.floor(b1.length/5);var bS=parseInt(b1.charAt(bX)+b1.charAt(bX*2)+b1.charAt(bX*3)+b1.charAt(bX*4)+b1.charAt(bX*5));var bQ=Math.ceil(bZ.length/2);var bY=Math.pow(2,31)-1;if(bS<2){e(2,"ERROR, Algorithm cannot find a suitable hash. Please choose a different key. \nPossible considerations are to choose a more complex or longer key.");return null}var bU=Math.round(Math.random()*1000000000)%100000000;b1+=bU;while(b1.length>10){b1=(parseInt(b1.substring(0,10))+parseInt(b1.substring(10,b1.length))).toString()}b1=(bS*b1+bQ)%bY;var bV="";var b0="";for(var bT=0;bT<bW.length;bT++){bV=parseInt(bW.charCodeAt(bT)^Math.floor((b1/bY)*255));if(bV<16){b0+="0"+bV.toString(16)}else{b0+=bV.toString(16)}b1=(bS*b1+bQ)%bY}bU=bU.toString(16);while(bU.length<8){bU="0"+bU}b0+=bU;return b0}catch(bR){g(2,"common: Encrypt",bR)}return null}function N(bW,bZ){try{if(bG(bW)||bW.length<8){e(2,"ERROR, A salt value could not be extracted from the encrypted message because it's length is too short. The message cannot be decrypted.");return null}if(bG(bZ)||bZ.length<1){e(2,"ERROR, Please enter a key with which to decrypt the message.");return null}var b1="";for(var bT=0;bT<bZ.length;bT++){b1+=bZ.charCodeAt(bT).toString()}var bX=Math.floor(b1.length/5);var bS=parseInt(b1.charAt(bX)+b1.charAt(bX*2)+b1.charAt(bX*3)+b1.charAt(bX*4)+b1.charAt(bX*5));var bQ=Math.round(bZ.length/2);var bY=Math.pow(2,31)-1;var bU=parseInt(bW.substring(bW.length-8,bW.length),16);bW=bW.substring(0,bW.length-8);b1+=bU;while(b1.length>10){b1=(parseInt(b1.substring(0,10))+parseInt(b1.substring(10,b1.length))).toString()}b1=(bS*b1+bQ)%bY;var bV="";var b0="";for(var bT=0;bT<bW.length;bT+=2){bV=parseInt(parseInt(bW.substring(bT,bT+2),16)^Math.floor((b1/bY)*255));b0+=String.fromCharCode(bV);b1=(bS*b1+bQ)%bY}return b0}catch(bR){g(2,"common: Decrypt",bR)}return null}var a7={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(bV){var bY="";var bS,bQ,bT,bZ,bR,bX,bW;var bU=0;bV=a7._utf8_encode(bV);while(bU<bV.length){bS=bV.charCodeAt(bU++);bQ=bV.charCodeAt(bU++);bT=bV.charCodeAt(bU++);bZ=bS>>2;bR=(bS&3)<<4|bQ>>4;bX=(bQ&15)<<2|bT>>6;bW=bT&63;if(isNaN(bQ)){bX=bW=64}else{if(isNaN(bT)){bW=64}}bY=bY+this._keyStr.charAt(bZ)+this._keyStr.charAt(bR)+this._keyStr.charAt(bX)+this._keyStr.charAt(bW)}return bY},decode:function(bV){var bY="";var bS,bQ,bT;var bZ,bR,bX,bW;var bU=0;bV=bV.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(bU<bV.length){bZ=this._keyStr.indexOf(bV.charAt(bU++));bR=this._keyStr.indexOf(bV.charAt(bU++));bX=this._keyStr.indexOf(bV.charAt(bU++));bW=this._keyStr.indexOf(bV.charAt(bU++));bS=bZ<<2|bR>>4;bQ=(bR&15)<<4|bX>>2;bT=(bX&3)<<6|bW;bY=bY+String.fromCharCode(bS);if(bX!=64){bY=bY+String.fromCharCode(bQ)}if(bW!=64){bY=bY+String.fromCharCode(bT)}}bY=a7._utf8_decode(bY);return bY},_utf8_encode:function(bS){bS=bS.replace(/\r\n/g,"\n");var bQ="";for(var bT=0;bT<bS.length;bT++){var bR=bS.charCodeAt(bT);if(bR<128){bQ+=String.fromCharCode(bR)}else{if(bR>127&&bR<2048){bQ+=String.fromCharCode(bR>>6|192);bQ+=String.fromCharCode(bR&63|128)}else{bQ+=String.fromCharCode(bR>>12|224);bQ+=String.fromCharCode(bR>>6&63|128);bQ+=String.fromCharCode(bR&63|128)}}}return bQ},_utf8_decode:function(bS){var bQ="";var bT=0;var bR=c1=c2=0;while(bT<bS.length){bR=bS.charCodeAt(bT);if(bR<128){bQ+=String.fromCharCode(bR);bT++}else{if(bR>191&&bR<224){c2=bS.charCodeAt(bT+1);bQ+=String.fromCharCode((bR&31)<<6|c2&63);bT+=2}else{c2=bS.charCodeAt(bT+1);c3=bS.charCodeAt(bT+2);bQ+=String.fromCharCode((bR&15)<<12|(c2&63)<<6|c3&63);bT+=3}}}return bQ}};function aL(){try{r.File.DeleteAllCookies();r.File.DeleteFile(aW(),function(bV){e(2,"EVENT, delsettings accounts result: "+bV)});r.File.DeleteFile(aZ(),function(bV){e(2,"EVENT, delsettings accounts result: "+bV)});var bT=bs("messagefiles");if(!bG(bT)){var bS=bT.split(",");for(var bQ=0;bQ<bS.length;bQ++){if(bG(bS[bQ])||bS[bQ].length<3){continue}var bU=bS[bQ].indexOf("[#");if(bU>0){bS[bQ]=bS[bQ].substring(0,bU)}r.File.DeleteFile(bS[bQ],function(bV){e(3,"EVENT, delsettings DeleteFile: "+bS[bQ]+" status: "+bV.toString())})}A("messagefiles","")}r.File.DeleteFile(r.ACCOUNTS_FILENAME,function(bV){e(2,"EVENT, delsettings accounts result: "+bV)});r.File.DeleteFile(r.CONTACTS_FILENAME,function(bV){e(2,"EVENT, delsettings contacts result: "+bV)})}catch(bR){g(2,"common: delsettings",bR)}}function ay(bT){var bS=bT;var bQ="";try{var bU=bS.indexOf("password");if(bU>0){bQ=bS.substring(0,bU)+"password: *****";bS=bS.substring(bU,bS.length);bS=bS.substring(bS.indexOf("\r\n"),bS.length);bQ=bQ+bS;return bQ}}catch(bR){g(2,"common: delsettings",bR)}return bT}var bB={PutToDebugLog:e,PutToDebugLogException:g,Trim:aa,ApiWinSaveFile:t,ApiWinLoadFile:aH,Exit:f};window.common_public=bB;return{InitializeSettings:ag,settmap:J,GetParameter:bs,SaveParameter:A,SaveSettingsFile:aJ,ReadSettingsFile:z,GetSettingsFromUrl:y,SETT_VALUE:a0,SETT_TYPE:bN,SETT_GROUP:d,SETT_ALLNAMES:bD,SETT_ALLVALUES:aA,SETT_ISDEFAULT:aX,CT_NAME:bj,CT_NUMBER:V,CT_PTYPE:ai,CT_USAGE:a9,CT_LASTMODIF:M,CT_DELFLAG:aj,CT_FAV:m,SaveContactsFile:aU,ReadContactsFile:D,GetContacts:at,SortContacts:by,GetContactIdFromNumber:I,GetContactNameFromNumber:bH,PickContact:az,CH_TYPE:au,CH_NAME:a4,CH_NUMBER:bf,CH_DATE:bK,CH_DURATION:o,CH_RECORDING:bA,SaveCallhistoryFile:af,ReadCallhistoryFile:an,AC_NAME:am,AC_SIPUSERNAME:aq,AC_SETTFILE:a6,AC_CHFILE:bw,AC_ISACTIVE:av,SaveAccountsFile:bI,ReadAccountsFile:aw,GetActiveAccount:bP,GetActiveAccSettingsFilename:aW,GetActiveAccCallhistoryFilename:aZ,WinAPI:bx,ApiWinSaveFile:t,ApiWinLoadFile:aH,ApiWinSaveFileNew:bu,StartMsg:aK,GetUA:bc,PutToDebugLog:e,PutToDebugLogException:g,ReplaceAll:v,Trim:aa,EscapeRegExp:b,IsNumber:bi,StrToInt:bb,StrToIntPx:ak,GetDeviceWidth:k,GetDeviceHeight:aC,IsWindowsSoftphone:ah,DeviceType:j,DEVICE_WEBPHONE:a2,DEVICE_WIN_SOFTPHONE:bl,DEVICE_ANDROID:a1,DEVICE_IPHONE:ax,DEVICE_BB:bL,DEVICE_WP:H,isNull:bG,getBgColor:bO,getElementColor:U,AlertDialog:a,ShowToast:bq,HelpWindow:ao,HoverCalc:E,IsIeVersion:ad,IsIeLocal:bt,GetTickCount:w,UpgradeToProVersion:s,OpenSettings:bz,GetIntentParam:bd,StripSpecialChar:bm,OpenWebURL:L,Md5Hash:a8,UriParser:aG,PutNotifications:aQ,ShowNotifications:br,HideCallNotifications:bg,HideMessageNotifications:aE,HideAllNotifications:aM,NotificationOnClick:bk,GetBrowser:C,Exit:f,EnterKeyPress:S,WinSoftphoneHttpReq:bn,bwanswer:aS,Encrypt:aF,Decrypt:N,enckey:ap,Base64:a7,delsettings:aL,GROUP_NOGROUP:Z,GROUP_MAIN:bM,GROUP_SIP:aP,GROUP_MEDIA:B,GROUP_CALLDIVERT:ar,GROUP_GENERAL:K,GROUP_INTEGRATE:ac,GROUP_VIDEO:bp,MIN_USR_PWD_LENGHT:l}});